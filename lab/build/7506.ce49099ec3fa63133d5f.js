"use strict";(self.webpackChunk_JUPYTERLAB_CORE_OUTPUT=self.webpackChunk_JUPYTERLAB_CORE_OUTPUT||[]).push([[7506,6493,4602],{17506:(e,t,s)=>{s.r(t),s.d(t,{IDocumentProviderFactory:()=>l,ProviderMock:()=>c,WebSocketProviderWithLocks:()=>S,getAnonymousUserName:()=>a,getRandomColor:()=>i,moonsOfJupyter:()=>n,userColors:()=>o});const n=["Metis","Adrastea","Amalthea","Thebe","Io","Europa","Ganymede","Callisto","Themisto","Leda","Ersa","Pandia","Himalia","Lysithea","Elara","Dia","Carpo","Valetudo","Euporie","Eupheme","Helike","Euanthe","Hermippe","Praxidike","Thyone","Thelxinoe","Ananke","Mneme","Orthosie","Harpalyke","Iocaste","Erinome","Aitne","Herse","Taygete","Eukelade","Carme","Isonoe","Autonoe","Philophrosyne","Cyllene","Pasithee","Pasiphae","Sponde","Eurydome","Kalyke","Hegemone","Kale","Kallichore","Chaldene","Arche","Eirene","Kore","Megaclite","Aoede","Callirrhoe","Sinope"],a=()=>"Anonymous "+n[Math.floor(Math.random()*n.length)],o=["#12A0D3","#17AB30","#CC8500","#A79011","#ee6352","#609DA9","#4BA749","#00A1B3"],i=()=>o[Math.floor(Math.random()*o.length)];class c{requestInitialContent(){return Promise.resolve(!1)}putInitializedState(){}acquireLock(){return Promise.resolve(0)}releaseLock(e){}destroy(){}setPath(e){}}var r=s(93315);const l=new r.Token("@jupyterlab/docprovider:IDocumentProviderFactory");var h=s(94072),d=s(84795),u=s(85230),f=s(62538),m=s(40870),p=s(68078),g=s(6493),y=s(31955),w=s(75736),_=s(21332),v=s(69600),b=s(59406);const k=[];k[0]=(e,t,s,n,a)=>{d.uE(e,0);const o=p.zu(t,e,s.doc,s);n&&o===p.Px&&!s.synced&&(s.synced=!0)},k[3]=(e,t,s,n,a)=>{d.uE(e,1),d.mP(e,g.xq(s.awareness,Array.from(s.awareness.getStates().keys())))},k[1]=(e,t,s,n,a)=>{g.oy(s.awareness,h.HN(t),s)},k[2]=(e,t,s,n,a)=>{((e,t,s)=>{switch(h.yg(e)){case 0:s(t,h.kf(e))}})(t,s.doc,I)};const I=(e,t)=>console.warn(`Permission denied to access ${e.url}.\n${t}`),M=(e,t,s)=>{const n=h.l1(t),a=d.Mf(),o=h.yg(n),i=e.messageHandlers[o];return i?i(a,n,e,s,o):console.error("Unable to compute message"),a},L=e=>{if(e.shouldConnect&&null===e.ws){const t=new e._WS(e.url);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=s=>{e.wsLastMessageReceived=m.ZG();const n=M(e,new Uint8Array(s.data),!0);d.kE(n)>1&&t.send(d._f(n))},t.onclose=()=>{e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,g.Ag(e.awareness,Array.from(e.awareness.getStates().keys()).filter((t=>t!==e.doc.clientID)),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(L,_.VV(1200*_.mv(e.wsUnsuccessfulReconnects+1),2500),e)},t.onopen=()=>{e.wsLastMessageReceived=m.ZG(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);const s=d.Mf();if(d.uE(s,0),p._J(s,e.doc),t.send(d._f(s)),null!==e.awareness.getLocalState()){const s=d.Mf();d.uE(s,1),d.mP(s,g.xq(e.awareness,[e.doc.clientID])),t.send(d._f(s))}},e.emit("status",[{status:"connecting"}])}},C=(e,t)=>{e.wsconnected&&e.ws.send(t),e.bcconnected&&e.mux((()=>{f.nY(e.bcChannel,t)}))};class U extends w.y{constructor(e,t,s,{connect:n=!0,awareness:a=new g.GL(s),params:o={},WebSocketPolyfill:i=WebSocket,resyncInterval:c=-1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);const r=(e=>v.UI(e,((e,t)=>`${encodeURIComponent(t)}=${encodeURIComponent(e)}`)).join("&"))(o);this.bcChannel=e+"/"+t,this.url=e+"/"+t+(0===r.length?"":"?"+r),this.roomname=t,this.doc=s,this._WS=i,this.awareness=a,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.wsUnsuccessfulReconnects=0,this.messageHandlers=k.slice(),this.mux=y.M(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=n,this._resyncInterval=0,c>0&&(this._resyncInterval=setInterval((()=>{if(this.ws){const e=d.Mf();d.uE(e,0),p._J(e,s),this.ws.send(d._f(e))}}),c)),this._bcSubscriber=e=>{this.mux((()=>{const t=M(this,new Uint8Array(e),!1);d.kE(t)>1&&f.nY(this.bcChannel,d._f(t))}))},this._updateHandler=(e,t)=>{if(t!==this){const t=d.Mf();d.uE(t,0),p.lr(t,e),C(this,d._f(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:e,updated:t,removed:s},n)=>{const o=e.concat(t).concat(s),i=d.Mf();d.uE(i,1),d.mP(i,g.xq(a,o)),C(this,d._f(i))},this._beforeUnloadHandler=()=>{g.Ag(this.awareness,[s.clientID],"window unload")},"undefined"!=typeof window?window.addEventListener("beforeunload",this._beforeUnloadHandler):b.on("exit",(()=>this._beforeUnloadHandler)),a.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval((()=>{this.wsconnected&&3e4<m.ZG()-this.wsLastMessageReceived&&this.ws.close()}),3e3),n&&this.connect()}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),"undefined"!=typeof window?window.removeEventListener("beforeunload",this._beforeUnloadHandler):b.off("exit",(()=>this._beforeUnloadHandler)),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){this.bcconnected||(f.Ld(this.bcChannel,this._bcSubscriber),this.bcconnected=!0),this.mux((()=>{const e=d.Mf();d.uE(e,0),p._J(e,this.doc),f.nY(this.bcChannel,d._f(e));const t=d.Mf();d.uE(t,0),p.K0(t,this.doc),f.nY(this.bcChannel,d._f(t));const s=d.Mf();d.uE(s,3),f.nY(this.bcChannel,d._f(s));const n=d.Mf();d.uE(n,1),d.mP(n,g.xq(this.awareness,[this.doc.clientID])),f.nY(this.bcChannel,d._f(n))}))}disconnectBc(){const e=d.Mf();d.uE(e,1),d.mP(e,g.xq(this.awareness,[this.doc.clientID],new Map)),C(this,d._f(e)),this.bcconnected&&(f.r1(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(L(this),this.connectBc())}}var E=s(40999);class S extends U{constructor(e){var t;super(e.url,e.contentType+":"+e.path,e.ymodel.ydoc,{awareness:e.ymodel.awareness}),this._currentLockRequest=null,this._initialContentRequest=null,this._path=e.path,this._contentType=e.contentType,this._serverUrl=e.url;const s="#"+E.jS("--usercolor",i().slice(1)),n=E.jS("--username",a()),o=e.ymodel.awareness.getLocalState();o&&null==(null===(t=o.user)||void 0===t?void 0:t.name)&&e.ymodel.awareness.setLocalStateField("user",{name:n,color:s}),this.messageHandlers[127]=(e,t,s,n,a)=>{const o=h.Jl(t),i=this._currentLockRequest;this._currentLockRequest=null,i&&i.resolve(o)},this.messageHandlers[125]=(e,t,s,n,a)=>{const o=h.iU(t);o.byteLength>0&&setTimeout((()=>{u.applyUpdate(this.doc,o)}),0);const i=this._initialContentRequest;this._initialContentRequest=null,i&&i.resolve(o.byteLength>0)},this._isInitialized=!1,this._onConnectionStatus=this._onConnectionStatus.bind(this),this.on("status",this._onConnectionStatus)}setPath(e){if(e!==this._path){this._path=e;const t=d.Mf();d.cW(t,123);const s=unescape(encodeURIComponent(this._contentType+":"+e));for(let e=0;e<s.length;e++)d.cW(t,s.codePointAt(e));this._sendMessage(d._f(t)),this.disconnectBc(),this.bcChannel=this._serverUrl+"/"+this._contentType+":"+this._path,this.url=this.bcChannel,this.connectBc()}}requestInitialContent(){return this._initialContentRequest||(this._initialContentRequest=new r.PromiseDelegate,this._sendMessage(new Uint8Array([125])),setTimeout((()=>{var e;return null===(e=this._initialContentRequest)||void 0===e?void 0:e.resolve(!1)}),1e3)),this._initialContentRequest.promise}putInitializedState(){const e=d.Mf();d.uE(e,124),d.HK(e,u.encodeStateAsUpdate(this.doc)),this._sendMessage(d._f(e)),this._isInitialized=!0}acquireLock(){if(this._currentLockRequest)return this._currentLockRequest.promise;let e,t;this._sendMessage(new Uint8Array([127])),this._requestLockInterval&&clearInterval(this._requestLockInterval),this._requestLockInterval=setInterval((()=>{this.wsconnected&&this._sendMessage(new Uint8Array([127]))}),500);const s=new Promise(((s,n)=>{e=s,t=n}));return this._currentLockRequest={promise:s,resolve:e,reject:t},s}releaseLock(e){const t=d.Mf();d.uE(t,126),d.Ep(t,e),this._sendMessage(d._f(t)),this._requestLockInterval&&clearInterval(this._requestLockInterval)}_sendMessage(e){const t=()=>{setTimeout((()=>{this.wsconnected?this.ws.send(e):this.once("status",t)}),0)};t()}async _onConnectionStatus(e){if(this._isInitialized&&"connected"===e.status){const e=await this.acquireLock();await this.requestInitialContent()||this.putInitializedState(),this.releaseLock(e)}}}},11565:(e,t,s)=>{s.d(t,{Z$:()=>n,s7:()=>a,Dp:()=>o,$m:()=>i});const n=e=>e[e.length-1],a=(e,t)=>{for(let s=0;s<t.length;s++)e.push(t[s])},o=Array.from,i=(e,t)=>{return e.length===t.length&&(s=(e,s)=>e===t[s],e.every(s));var s}},62538:(e,t,s)=>{s.d(t,{Ld:()=>l,r1:()=>h,nY:()=>d});var n=s(23205),a=s(24803),o=s(55852);const i=new Map,c="undefined"==typeof BroadcastChannel?class{constructor(e){this.room=e,this.onmessage=null,o.z((t=>t.key===e&&null!==this.onmessage&&this.onmessage({data:a.Gh(t.newValue||"")})))}postMessage(e){o.X.setItem(this.room,a.s3(a.eh(e)))}}:BroadcastChannel,r=e=>n.Yu(i,e,(()=>{const t=new Set,s=new c(e);return s.onmessage=e=>t.forEach((t=>t(e.data))),{bc:s,subs:t}})),l=(e,t)=>r(e).subs.add(t),h=(e,t)=>r(e).subs.delete(t),d=(e,t)=>{const s=r(e);s.bc.postMessage(t),s.subs.forEach((e=>e(t)))}},1872:(e,t,s)=>{s.d(t,{PP:()=>o,WY:()=>i,UV:()=>c,Hi:()=>r});var n=s(11565),a=s(69600);const o=(e,t,s=0)=>{try{for(;s<e.length;s++)e[s](...t)}finally{s<e.length&&o(e,t,s+1)}},i=()=>{},c=(e,t)=>e===t||null!=e&&null!=t&&e.constructor===t.constructor&&(e instanceof Array&&n.$m(e,t)||"object"==typeof e&&a.$m(e,t)),r=(e,t)=>{if(null==e||null==t)return((e,t)=>e===t)(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!1;break;case Set:if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;break;case Map:if(e.size!==t.size)return!1;for(const s of e.keys())if(!t.has(s)||!r(e.get(s),t.get(s)))return!1;break;case Object:if(a.kE(e)!==a.kE(t))return!1;for(const s in e)if(!a.l$(e,s)||!r(e[s],t[s]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!r(e[s],t[s]))return!1;break;default:return!1}return!0}},21332:(e,t,s)=>{s.d(t,{GW:()=>n,Wn:()=>a,mv:()=>o,IH:()=>i,VV:()=>c,Fp:()=>r,GR:()=>l});const n=Math.floor,a=(Math.ceil,Math.abs),o=(Math.imul,Math.round,Math.log10),i=(Math.log2,Math.log,Math.sqrt,(e,t)=>e+t),c=(e,t)=>e<t?e:t,r=(e,t)=>e>t?e:t,l=(Number.isNaN,Math.pow,Math.sign,e=>0!==e?e<0:1/e<0)},31955:(e,t,s)=>{s.d(t,{M:()=>n});const n=()=>{let e=!0;return(t,s)=>{if(e){e=!1;try{t()}finally{e=!0}}else void 0!==s&&s()}}},69600:(e,t,s)=>{s.d(t,{UI:()=>a,kE:()=>o,l$:()=>i,$m:()=>c}),Object.assign;const n=Object.keys,a=(e,t)=>{const s=[];for(const n in e)s.push(t(e[n],n));return s},o=e=>n(e).length,i=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c=(e,t)=>e===t||o(e)===o(t)&&((e,t)=>{for(const s in e)if(!t(e[s],s))return!1;return!0})(e,((e,s)=>(void 0!==e||i(t,s))&&t[s]===e))},6493:(e,t,s)=>{s.d(t,{GL:()=>l,Ag:()=>h,xq:()=>d,oy:()=>u});var n=s(84795),a=s(94072),o=s(40870),i=s(21332),c=s(75736),r=s(1872);s(85230);class l extends c.y{constructor(e){super(),this.doc=e,this.clientID=e.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval((()=>{const e=o.ZG();null!==this.getLocalState()&&15e3<=e-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const t=[];this.meta.forEach(((s,n)=>{n!==this.clientID&&3e4<=e-s.lastUpdated&&this.states.has(n)&&t.push(n)})),t.length>0&&h(this,t,"timeout")}),i.GW(3e3)),e.on("destroy",(()=>{this.destroy()})),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(e){const t=this.clientID,s=this.meta.get(t),n=void 0===s?0:s.clock+1,a=this.states.get(t);null===e?this.states.delete(t):this.states.set(t,e),this.meta.set(t,{clock:n,lastUpdated:o.ZG()});const i=[],c=[],l=[],h=[];null===e?h.push(t):null==a?null!=e&&i.push(t):(c.push(t),r.Hi(a,e)||l.push(t)),(i.length>0||l.length>0||h.length>0)&&this.emit("change",[{added:i,updated:l,removed:h},"local"]),this.emit("update",[{added:i,updated:c,removed:h},"local"])}setLocalStateField(e,t){const s=this.getLocalState();null!==s&&this.setLocalState({...s,[e]:t})}getStates(){return this.states}}const h=(e,t,s)=>{const n=[];for(let s=0;s<t.length;s++){const a=t[s];if(e.states.has(a)){if(e.states.delete(a),a===e.clientID){const t=e.meta.get(a);e.meta.set(a,{clock:t.clock+1,lastUpdated:o.ZG()})}n.push(a)}}n.length>0&&(e.emit("change",[{added:[],updated:[],removed:n},s]),e.emit("update",[{added:[],updated:[],removed:n},s]))},d=(e,t,s=e.states)=>{const a=t.length,o=n.Mf();n.uE(o,a);for(let i=0;i<a;i++){const a=t[i],c=s.get(a)||null,r=e.meta.get(a).clock;n.uE(o,a),n.uE(o,r),n.uw(o,JSON.stringify(c))}return n._f(o)},u=(e,t,s)=>{const n=a.l1(t),i=o.ZG(),c=[],l=[],h=[],d=[],u=a.yg(n);for(let t=0;t<u;t++){const t=a.yg(n);let s=a.yg(n);const o=JSON.parse(a.kf(n)),u=e.meta.get(t),f=e.states.get(t),m=void 0===u?0:u.clock;(m<s||m===s&&null===o&&e.states.has(t))&&(null===o?t===e.clientID&&null!=e.getLocalState()?s++:e.states.delete(t):e.states.set(t,o),e.meta.set(t,{clock:s,lastUpdated:i}),void 0===u&&null!==o?c.push(t):void 0!==u&&null===o?d.push(t):null!==o&&(r.Hi(o,f)||h.push(t),l.push(t)))}(c.length>0||h.length>0||d.length>0)&&e.emit("change",[{added:c,updated:h,removed:d},s]),(c.length>0||l.length>0||d.length>0)&&e.emit("update",[{added:c,updated:l,removed:d},s])}},68078:(e,t,s)=>{s.d(t,{Wh:()=>i,Px:()=>c,_J:()=>r,K0:()=>l,lr:()=>d,zu:()=>f});var n=s(84795),a=s(94072),o=s(85230);const i=0,c=1,r=(e,t)=>{n.uE(e,i);const s=o.encodeStateVector(t);n.mP(e,s)},l=(e,t,s)=>{n.uE(e,c),n.mP(e,o.encodeStateAsUpdate(t,s))},h=(e,t,s)=>{try{o.applyUpdate(t,a.HN(e),s)}catch(e){console.error("Caught error while handling a Yjs update",e)}},d=(e,t)=>{n.uE(e,2),n.mP(e,t)},u=h,f=(e,t,s,n)=>{const o=a.yg(e);switch(o){case i:((e,t,s)=>{l(t,s,a.HN(e))})(e,t,s);break;case c:h(e,s,n);break;case 2:u(e,s,n);break;default:throw new Error("Unknown message type")}return o}}}]);
//# sourceMappingURL=7506.ce49099ec3fa63133d5f.js.map