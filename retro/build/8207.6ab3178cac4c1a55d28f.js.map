{"version":3,"file":"8207.6ab3178cac4c1a55d28f.js","mappings":"maAQA,MAAMA,EAAYC,GAAMC,KAAKC,MAAMD,KAAKE,UAAUH,IAC3C,MAAMI,EACTC,cACIC,KAAKC,YAAa,EAClBD,KAAKE,KAAO,IAAI,MAChBF,KAAKG,OAASH,KAAKE,KAAKE,QAAQ,UAChCJ,KAAKK,OAASL,KAAKE,KAAKI,OAAO,SAC/BN,KAAKO,YAAc,IAAI,cAAc,CAACP,KAAKG,QAAS,CAChDK,eAAgB,IAAIC,IAAI,CAACT,SAE7BA,KAAKU,UAAY,IAAI,KAAUV,KAAKE,MACpCF,KAAKW,SAAW,IAAI,EAAAC,OAAOZ,MAM/Ba,SAASC,EAAGC,GAAW,GACnBf,KAAKE,KAAKW,SAASC,EAAGC,EAAWf,KAAO,MAK5CgB,UACIhB,KAAKC,YAAa,EAClBD,KAAKE,KAAKe,UAKdC,UACI,OAAOlB,KAAKO,YAAYY,UAAUC,OAAS,EAK/CC,UACI,OAAOrB,KAAKO,YAAYe,UAAUF,OAAS,EAK/CG,OACIvB,KAAKO,YAAYgB,OAKrBC,OACIxB,KAAKO,YAAYiB,OAKrBC,mBACIzB,KAAKO,YAAYmB,QAKrB,cACI,OAAO1B,KAAKW,UAGb,MAAMgB,UAAc7B,EACvBC,cACI6B,QAIA5B,KAAK6B,eAAkBC,IACnB,MAAMC,EAAU,GAChBA,EAAQC,aAAeF,EAAMC,QAAQE,MACrCjC,KAAKW,SAASuB,KAAKH,IAKvB/B,KAAKmC,gBAAmBL,IACpB,MAAMM,EAAc,GACpBN,EAAMO,YAAYC,SAAQC,IACtB,MAAMC,EAASV,EAAMC,QAAQU,KAAKC,IAAIH,GACtCH,EAAYO,KAAK,CACbC,KAAML,EACNM,UAAWL,MAAAA,OAAuC,EAASA,EAAOK,UAAYL,EAAOK,SAAW,EAChGC,SAAU9C,KAAKK,OAAOqC,IAAIH,QAGlCvC,KAAKW,SAASuB,KAAK,CAAEE,YAAAA,KAEzBpC,KAAK+C,QAAU/C,KAAKE,KAAKE,QAAQ,UACjCJ,KAAK+C,QAAQC,QAAQhD,KAAK6B,gBAC1B7B,KAAKK,OAAO2C,QAAQhD,KAAKmC,iBAK7BnB,UACIhB,KAAK+C,QAAQE,UAAUjD,KAAK6B,gBAC5B7B,KAAKK,OAAO4C,UAAUjD,KAAKmC,iBAE/B,gBACI,OAAO,IAAIR,EAOfuB,YACI,OAAOlD,KAAK+C,QAAQI,WAOxBC,UAAUC,GACNrD,KAAKa,UAAS,KACV,MAAMyC,EAAQtD,KAAK+C,QACnBO,EAAMC,OAAO,EAAGD,EAAMlC,QACtBkC,EAAME,OAAO,EAAGH,MAYxBI,aAAaC,EAAOC,EAAKN,EAAQ,IAC7BrD,KAAKa,UAAS,KACV,MAAMkC,EAAU/C,KAAK+C,QAGrBA,EAAQS,OAAOE,EAAOL,GACtBN,EAAQQ,OAAOG,EAAQL,EAAMjC,OAAQuC,EAAMD,OAchD,MAAME,UAAkB9D,EAC3BC,YAAY8D,GACRjC,QAIA5B,KAAK8D,iBAAoBhC,IAErBA,EAAMC,QAAQgC,MAAMzB,SAAQ0B,IACxB,MAAMC,EAAOD,EAAKE,QAAQD,KACrBjE,KAAKmE,cAAcC,IAAIH,IACxBjE,KAAKmE,cAAcE,IAAIJ,EAAMK,EAAmBL,IAEpD,MAAMM,EAAOvE,KAAKmE,cAAczB,IAAIuB,GACpCM,EAAKC,UAAYxE,KACZA,KAAKyE,4BAINF,EAAKG,aAAe,IAAI,cAAc,CAACH,EAAKI,QAAS,IAHrDJ,EAAKG,aAAe1E,KAAKO,eAMjCuB,EAAMC,QAAQ6C,QAAQtC,SAAQ0B,IAC1B,MAAMC,EAAOD,EAAKE,QAAQD,KACpBY,EAAQ7E,KAAKmE,cAAczB,IAAIuB,GACjCY,IACAA,EAAM7D,UACNhB,KAAKmE,cAAcZ,OAAOU,OAGlC,IAAIa,EAAQ,EAEZ,MAAMC,EAAc,GACpBjD,EAAMC,QAAQE,MAAMK,SAAS0C,IACzB,GAAgB,MAAZA,EAAExB,OAAgB,CAClB,MAAMyB,EAAgBD,EAAExB,OAAO0B,KAAKC,GAAUnF,KAAKmE,cAAczB,IAAIyC,KACrEJ,EAAYpC,KAAK,CAAEa,OAAQyB,IAC3BjF,KAAKoF,MAAMC,OAAOP,EAAO,KAAMG,GAC/BH,GAASE,EAAExB,OAAOpC,YAED,MAAZ4D,EAAEzB,QACPwB,EAAYpC,KAAKqC,GACjBhF,KAAKoF,MAAMC,OAAOP,EAAOE,EAAEzB,SAEV,MAAZyB,EAAEM,SACPP,EAAYpC,KAAKqC,GACjBF,GAASE,EAAEM,WAGnBtF,KAAKW,SAASuB,KAAK,CACf6C,YAAaA,KAMrB/E,KAAKuF,mBAAsBzD,IACvB,GAAIA,EAAMO,YAAY+B,IAAI,YAAa,CACnC,MAAM5B,EAASV,EAAMC,QAAQU,KAAKC,IAAI,YAChC8C,EAAiB,CACnB3C,UAAWL,MAAAA,OAAuC,EAASA,EAAOK,UAAYL,EAAOK,cAAW4C,EAChG3C,SAAU9C,KAAK0F,eAEnB1F,KAAKW,SAASuB,KAAK,CAAEsD,eAAAA,MAM7BxF,KAAKmC,gBAAmBL,IACpB,MAAMM,EAAc,GACpBN,EAAMO,YAAYC,SAAQC,IACtB,MAAMC,EAASV,EAAMC,QAAQU,KAAKC,IAAIH,GACtCH,EAAYO,KAAK,CACbC,KAAML,EACNM,UAAWL,MAAAA,OAAuC,EAASA,EAAOK,UAAYL,EAAOK,SAAW,EAChGC,SAAU9C,KAAKK,OAAOqC,IAAIH,QAGlCvC,KAAKW,SAASuB,KAAK,CAAEE,YAAAA,KAEzBpC,KAAK2F,OAAS3F,KAAKE,KAAK0F,SAAS,SACjC5F,KAAK6F,MAAQ7F,KAAKE,KAAKI,OAAO,QAC9BN,KAAK2E,OAAS3E,KAAKE,KAAKI,OAAO,SAC/BN,KAAKO,YAAc,IAAI,cAAc,CAACP,KAAK2F,QAAS,CAChDnF,eAAgB,IAAIC,IAAI,CAACT,SAE7BA,KAAKmE,cAAgB,IAAI2B,IACzB9F,KAAK+F,6BAA+BlC,EAAQY,4BAC5CzE,KAAK2F,OAAO3C,QAAQhD,KAAK8D,kBACzB9D,KAAKoF,MAAQpF,KAAK2F,OAAOK,UAAUd,KAAIC,IAC9BnF,KAAKmE,cAAcC,IAAIe,IACxBnF,KAAKmE,cAAcE,IAAIc,EAAOb,EAAmBa,IAE9CnF,KAAKmE,cAAczB,IAAIyC,MAElCnF,KAAK6F,MAAM7C,QAAQhD,KAAKuF,oBACxBvF,KAAKK,OAAO2C,QAAQhD,KAAKmC,iBAE7B,eACI,OAAOnC,KAAKK,OAAOqC,IAAI,YAE3B,aAAaW,GACTrD,KAAKa,UAAS,KACVb,KAAKK,OAAOgE,IAAI,WAAYhB,MAC7B,GAEP,qBACI,OAAOrD,KAAKK,OAAOqC,IAAI,iBAE3B,mBAAmBW,GACfrD,KAAKa,UAAS,KACVb,KAAKK,OAAOgE,IAAI,gBAAiBhB,MAClC,GAKPrC,UACIhB,KAAK2F,OAAO1C,UAAUjD,KAAK8D,kBAC3B9D,KAAK6F,MAAM5C,UAAUjD,KAAKuF,oBAC1BvF,KAAKK,OAAO4C,UAAUjD,KAAKmC,iBAS/B8D,QAAQnB,GACJ,OAAO9E,KAAKoF,MAAMN,GAStBoB,WAAWpB,EAAOP,GACdvE,KAAKmG,YAAYrB,EAAO,CAACP,IAS7B4B,YAAYrB,EAAOM,GACfA,EAAM9C,SAAQiC,IACVvE,KAAKmE,cAAcE,IAAIE,EAAKI,OAAQJ,GAC/BvE,KAAKyE,8BACNF,EAAKhE,YAAcP,KAAKO,gBAGhCP,KAAKa,UAAS,KACVb,KAAK2F,OAAOnC,OAAOsB,EAAOM,EAAMF,KAAIX,GAAQA,EAAKI,aAUzDyB,SAASC,EAAWC,GAChBtG,KAAKa,UAAS,KACV,MAAM0F,EAAWvG,KAAKiG,QAAQI,GAAWG,QACzCxG,KAAKyG,WAAWJ,GAChBrG,KAAKkG,WAAWI,EAASC,MAQjCE,WAAW3B,GACP9E,KAAK0G,gBAAgB5B,EAAOA,EAAQ,GASxC4B,gBAAgBC,EAAMC,GAClB5G,KAAKa,UAAS,KACVb,KAAK2F,OAAOpC,OAAOoD,EAAMC,EAAKD,MAQtCjB,cACI,MAAMmB,EAAO7G,KAAK6F,MAAMnD,IAAI,YAC5B,OAAOmE,EAAOpH,EAASoH,GAAQ,CAAEC,cAAe,GAOpDC,YAAY1D,GACRrD,KAAK6F,MAAMxB,IAAI,WAAY5E,EAAS4D,IAOxC2D,eAAe3D,GAEXrD,KAAK6F,MAAMxB,IAAI,WAAY4C,OAAOC,OAAO,GAAIlH,KAAK0F,cAAerC,IAKrE,cAAcoB,GACV,OAAO,IAAIb,EAAU,CAAEa,4BAAAA,IAQ3B,kCACI,OAAOzE,KAAK+F,8BAMb,MAAMzB,EAAsBL,IAC/B,OAAQA,EAAKvB,IAAI,cACb,IAAK,OACD,OAAO,IAAIyE,EAAUlD,GACzB,IAAK,WACD,OAAO,IAAImD,EAAcnD,GAC7B,IAAK,MACD,OAAO,IAAIoD,EAASpD,GACxB,QACI,MAAM,IAAIqD,MAAM,6BAMfC,EAAuB,CAACC,EAAUC,KAC3C,OAAQD,GACJ,IAAK,WACD,OAAOJ,EAAcM,iBAAiBD,GAC1C,IAAK,OACD,OAAON,EAAUO,iBAAiBD,GACtC,QAEI,OAAOJ,EAASK,iBAAiBD,KAGtC,MAAME,EACT5H,YAAY4E,GAIR3E,KAAKwE,UAAY,KAQjBxE,KAAK4H,cAAe,EAIpB5H,KAAK6B,eAAkBgG,IACnB,MAAM9F,EAAU,GACV+F,EAAcD,EAAOE,MAAKjG,GAASA,EAAMkG,SAAWhI,KAAK2E,OAAOjC,IAAI,YACtEoF,IACA/F,EAAQC,aAAe8F,EAAY/F,QAAQE,OAE/C,MAAMgG,EAAcJ,EAAOE,MAAKjG,GAASA,EAAMkG,SAAWhI,KAAK2E,OAAOjC,IAAI,aACtEuF,IACAlG,EAAQmG,cAAgBD,EAAYlG,QAAQE,OAEhD,MAAMkG,EAAaN,EAAOE,MAAKjG,GAASA,EAAMkG,SAAWhI,KAAK2E,SAC9D,GAAIwD,GAAcA,EAAW9F,YAAY+B,IAAI,YAAa,CACtD,MAAM5B,EAAS2F,EAAWpG,QAAQU,KAAKC,IAAI,YAC3CX,EAAQyD,eAAiB,CACrB3C,UAAWL,MAAAA,OAAuC,EAASA,EAAOK,UAAYL,EAAOK,cAAW4C,EAChG3C,SAAU9C,KAAK0F,eAGvB,GAAIyC,GAAcA,EAAW9F,YAAY+B,IAAI,mBAAoB,CAC7D,MAAM5B,EAAS2F,EAAWpG,QAAQU,KAAKC,IAAI,mBAC3CX,EAAQqG,qBAAuB,CAC3BvF,SAAUL,EAAOK,SACjBC,SAAU9C,KAAK2E,OAAOjC,IAAI,oBAKlC,MAAMK,EAAU/C,KAAK2E,OAAOjC,IAAI,UAC5ByF,GAAcA,EAAW9F,YAAY+B,IAAI,YACzCrC,EAAQC,aAAe,CACnB,CAAEuB,OAAQvD,KAAKqI,mBACf,CAAE7E,OAAQT,EAAQI,cAG1BnD,KAAKqI,kBAAoBtF,EAAQ3B,OACjCpB,KAAKW,SAASuB,KAAKH,IAEvB/B,KAAKC,YAAa,EAClBD,KAAK0E,aAAe,KACpB1E,KAAKW,SAAW,IAAI,EAAAC,OAAOZ,MAC3BA,KAAK2E,OAASA,EACd,MAAM5B,EAAU4B,EAAOjC,IAAI,UAC3B1C,KAAKqI,kBAAoBtF,EAAUA,EAAQ3B,OAAS,EACpDpB,KAAK2E,OAAO2D,YAAYtI,KAAK6B,gBAEjC,cACI,OAAO7B,KAAK2E,OAAOjC,IAAI,UAE3B,gBACI,IAAI6F,EACJ,OAAiC,QAAxBA,EAAKvI,KAAKwI,gBAA6B,IAAPD,OAAgB,EAASA,EAAG7H,YAAc,KAMvFG,SAASC,EAAGC,GAAW,GACnBf,KAAKwI,UAAYzH,EACXf,KAAKwI,SAAS3H,SAASC,GACvBd,KAAK2E,OAAO8D,IAAI5H,SAASC,EAAGd,MAKtC,kBACI,IAAIuI,EACJ,OAAKvI,KAAKwI,UAGuB,QAAxBD,EAAKvI,KAAKwI,gBAA6B,IAAPD,OAAgB,EAASA,EAAG9D,6BAA+BzE,KAAK0E,aACnG1E,KAAKwI,SAASjI,YAHTP,KAAK0E,aAQpB,gBAAgBnE,GACZP,KAAK0E,aAAenE,EAKxBgB,OACI,IAAIgH,EACwB,QAA3BA,EAAKvI,KAAKO,mBAAgC,IAAPgI,GAAyBA,EAAGhH,OAKpEC,OACI,IAAI+G,EACwB,QAA3BA,EAAKvI,KAAKO,mBAAgC,IAAPgI,GAAyBA,EAAG/G,OAKpEN,UACI,QAASlB,KAAKO,aAAeP,KAAKO,YAAYY,UAAUC,OAAS,EAKrEC,UACI,QAASrB,KAAKO,aAAeP,KAAKO,YAAYe,UAAUF,OAAS,EAKrEK,mBACI,IAAI8G,EACwB,QAA3BA,EAAKvI,KAAKO,mBAAgC,IAAPgI,GAAyBA,EAAG7G,QAKpE,eACI,OAAO1B,KAAKwE,UAKhB,cAAciD,EAAK,EAAAiB,KAAA,SACf,MAAM/D,EAAS,IAAI,MACb5B,EAAU,IAAI,OAKpB,OAJA4B,EAAON,IAAI,SAAUtB,GACrB4B,EAAON,IAAI,WAAY,IACvBM,EAAON,IAAI,YAAarE,KAAK2I,UAAUC,WACvCjE,EAAON,IAAI,KAAMoD,GACV,IAAIzH,KAAK2E,GAOpB,wBAAwB8C,GACpB,MAAMlD,EAAOvE,KAAK6I,OAAOpB,GAMzB,OALAlD,EAAKqD,cAAe,GACpB,IAAI,OAAQhC,WAAWpC,OAAO,EAAG,CAACe,EAAKI,SACvCJ,EAAKG,aAAe,IAAI,cAAc,CAACH,EAAKI,QAAS,CACjDnE,eAAgB,IAAIC,IAAI,CAAC8D,MAEtBA,EAOXiC,QACI,MAAM7B,EAAS,IAAI,MACb5B,EAAU,IAAI,OAAO/C,KAAKkD,aAChCyB,EAAON,IAAI,SAAUtB,GACrB4B,EAAON,IAAI,WAAYrE,KAAK0F,eAC5Bf,EAAON,IAAI,YAAarE,KAAK4I,WAC7BjE,EAAON,IAAI,KAAMrE,KAAK8I,SACtB,MACMtC,EAAQ,IAAIuC,EADL/I,KAAKD,aACK4E,GAIvB,OADA6B,EAAM9B,aAAe1E,KAAKO,YACnBiG,EAKX,cACI,OAAOxG,KAAKW,SAKhBK,UACIhB,KAAK2E,OAAOqE,cAAchJ,KAAK6B,gBAOnCoH,iBACI,OAAOjJ,KAAK2E,OAAOjC,IAAI,eAO3BwG,eAAeC,GACXnJ,KAAKa,UAAS,KACS,MAAfsI,EACAnJ,KAAK2E,OAAON,IAAI,cAAe8E,GAG/BnJ,KAAK2E,OAAOpB,OAAO,kBAS/BuF,QACI,OAAO9I,KAAK2E,OAAOjC,IAAI,MAO3BQ,YACI,OAAOlD,KAAK2E,OAAOjC,IAAI,UAAUS,WAOrCC,UAAUC,GACN,MAAMC,EAAQtD,KAAK2E,OAAOjC,IAAI,UAC9B1C,KAAKa,UAAS,KACVyC,EAAMC,OAAO,EAAGD,EAAMlC,QACtBkC,EAAME,OAAO,EAAGH,MAcxBI,aAAaC,EAAOC,EAAKN,EAAQ,IAC7BrD,KAAKa,UAAS,KACV,MAAMkC,EAAU/C,KAAK+C,QAGrBA,EAAQS,OAAOE,EAAOL,GACtBN,EAAQQ,OAAOG,EAAQL,EAAMjC,OAAQuC,EAAMD,MAMnD,gBACI,MAAM,IAAI4D,MAAM,uCAOpB5B,cACI,OAAOjG,EAASO,KAAK2E,OAAOjC,IAAI,aAOpCqE,YAAY1D,GACRrD,KAAKa,UAAS,KACVb,KAAK2E,OAAON,IAAI,WAAY5E,EAAS4D,OAM7C+F,SACI,MAAO,CACH3B,GAAIzH,KAAK8I,QACTF,UAAW5I,KAAK4I,UAChBzI,OAAQH,KAAKkD,YACbmG,SAAUrJ,KAAK0F,gBAIpB,MAAMyB,UAAkBQ,EAI3B,gBACI,MAAO,OAKX,sBACI,OAAO3H,KAAK2E,OAAOjC,IAAI,mBAK3B,oBAAoB4G,GAChBtJ,KAAKa,UAAS,KACVb,KAAK2E,OAAON,IAAI,kBAAmBiF,MAM3CC,aACI,OAAO9J,EAASO,KAAK2E,OAAOjC,IAAI,WAAWsD,WAK/CwD,WAAWC,GACP,MAAMC,EAAW1J,KAAK2E,OAAOjC,IAAI,WACjC1C,KAAKa,UAAS,KACV6I,EAASnG,OAAO,EAAGmG,EAAStI,QAC5BsI,EAASlG,OAAO,EAAGiG,MACpB,GAWPE,cAAcjG,EAAOC,EAAK8F,EAAU,IAChC,MAAMC,EAAW1J,KAAK2E,OAAOjC,IAAI,WAC3BkH,EAAMjG,EAAM+F,EAAStI,OAASuC,EAAMD,EAAQgG,EAAStI,OAASsC,EACpE1D,KAAKa,UAAS,KACV6I,EAASnG,OAAOG,EAAOkG,GACvBF,EAASlG,OAAOE,EAAO+F,MACxB,GAKP,cAAchC,GACV,MAAMlD,EAAO3C,MAAMiH,OAAOpB,GAG1B,OAFAlD,EAAKI,OAAON,IAAI,kBAAmB,GACnCE,EAAKI,OAAON,IAAI,UAAW,IAAI,SACxBE,EAOX,wBAAwBkD,GACpB,MAAMlD,EAAO3C,MAAM8F,iBAAiBD,GAGpC,OAFAlD,EAAKI,OAAON,IAAI,kBAAmB,MACnCE,EAAKI,OAAON,IAAI,UAAW,IAAI,SACxBE,EAOXiC,QACI,MAAMjC,EAAO3C,MAAM4E,QACbkD,EAAW,IAAI,QAIrB,OAHAA,EAASlG,OAAO,EAAGxD,KAAKuJ,cACxBhF,EAAKI,OAAON,IAAI,kBAAmBrE,KAAK6J,iBACxCtF,EAAKI,OAAON,IAAI,UAAWqF,GACpBnF,EAKX6E,SACI,MAAO,CACH3B,GAAIzH,KAAK8I,QACTF,UAAW,OACXzI,OAAQH,KAAKkD,YACbmG,SAAUrJ,KAAK0F,cACf+D,QAASzJ,KAAKuJ,aACdM,gBAAiB7J,KAAK6J,kBAI3B,MAAMxC,UAAiBM,EAI1B,cAAcF,GACV,OAAO7F,MAAMiH,OAAOpB,GAOxB,wBAAwBA,GACpB,OAAO7F,MAAM8F,iBAAiBD,GAKlC,gBACI,MAAO,MAKX2B,SACI,MAAO,CACH3B,GAAIzH,KAAK8I,QACTF,UAAW,MACXzI,OAAQH,KAAKkD,YACbmG,SAAUrJ,KAAK0F,cACfyD,YAAanJ,KAAKiJ,mBAIvB,MAAM7B,UAAsBO,EAI/B,cAAcF,GACV,OAAO7F,MAAMiH,OAAOpB,GAOxB,wBAAwBA,GACpB,OAAO7F,MAAM8F,iBAAiBD,GAKlC,gBACI,MAAO,WAKX2B,SACI,MAAO,CACH3B,GAAIzH,KAAK8I,QACTF,UAAW,WACXzI,OAAQH,KAAKkD,YACbmG,SAAUrJ,KAAK0F,cACfyD,YAAanJ,KAAKiJ,mBCt3BvB,SAASa,EAA4BhI,GACxC,IAAIC,EAAU,IAAI+D,IAQlB,OAPAhE,EAAMC,QAAQU,KAAKH,SAAQ,CAACR,EAAOS,KAC/BR,EAAQsC,IAAI9B,EAAK,CACbwH,OAAQjI,EAAMiI,OACdlH,SAAUf,EAAMe,SAChBC,SAAU9C,KAAK6F,MAAMnD,IAAIH,QAG1BR,EAeJ,MAAMiI,EAAc,KACvB,IAAIC,GAAQ,EACZ,OAAQnJ,IACJ,GAAImJ,EAAO,CACPA,GAAQ,EACR,IACInJ,IAEJ,QACImJ,GAAQ,O,6DCxBjB,MAAMC,EAAOC,GAAOA,EAAIA,EAAI/I,OAAS,GAsB/BgJ,EAAW,CAACC,EAAMC,KAC7B,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAIlJ,OAAQmJ,IAC9BF,EAAK1H,KAAK2H,EAAIC,KAYL5D,EAAO6D,MAAM7D,KAgCb8D,EAAY,CAACC,EAAGC,KAAMD,OAAAA,EAAEtJ,SAAWuJ,EAAEvJ,SApBvBN,EAoB0C,CAACkD,EAAMc,IAAUd,IAAS2G,EAAE7F,GAA/B4F,EApB7BE,MAAM9J,IAAtB,IAAMA,I,sFC9CpB,MAAM+J,EAAU,CAACC,EAAIC,EAAMR,EAAI,KACpC,IACE,KAAOA,EAAIO,EAAG1J,OAAQmJ,IACpBO,EAAGP,MAAMQ,GAEX,QACIR,EAAIO,EAAG1J,QACTyJ,EAAQC,EAAIC,EAAMR,EAAI,KAKfS,EAAM,OAiCNC,EAAe,CAACP,EAAGC,IAAMD,IAAMC,GAAW,MAALD,GAAkB,MAALC,GAAaD,EAAE3K,cAAgB4K,EAAE5K,cAAiB2K,aAAaF,OAAS,KAAgBE,EAA2B,IAAuB,iBAANA,GAAkB,KAAiBA,EAAGC,IAO5NO,EAAe,CAACR,EAAGC,KAC9B,GAAS,MAALD,GAAkB,MAALC,EACf,MAlB0B,EAACD,EAAGC,IAAMD,IAAMC,EAkBnCQ,CAAeT,EAAGC,GAE3B,GAAID,EAAE3K,cAAgB4K,EAAE5K,YACtB,OAAO,EAET,GAAI2K,IAAMC,EACR,OAAO,EAET,OAAQD,EAAE3K,aACR,KAAKqL,YACHV,EAAI,IAAIW,WAAWX,GACnBC,EAAI,IAAIU,WAAWV,GAErB,KAAKU,WACH,GAAIX,EAAEY,aAAeX,EAAEW,WACrB,OAAO,EAET,IAAK,IAAIf,EAAI,EAAGA,EAAIG,EAAEtJ,OAAQmJ,IAC5B,GAAIG,EAAEH,KAAOI,EAAEJ,GACb,OAAO,EAGX,MAEF,KAAK9J,IACH,GAAIiK,EAAEa,OAASZ,EAAEY,KACf,OAAO,EAET,IAAK,MAAMlI,KAASqH,EAClB,IAAKC,EAAEvG,IAAIf,GACT,OAAO,EAGX,MAEF,KAAKyC,IACH,GAAI4E,EAAEa,OAASZ,EAAEY,KACf,OAAO,EAET,IAAK,MAAMhJ,KAAOmI,EAAEjI,OAClB,IAAKkI,EAAEvG,IAAI7B,KAAS2I,EAAaR,EAAEhI,IAAIH,GAAMoI,EAAEjI,IAAIH,IACjD,OAAO,EAGX,MAEF,KAAK0E,OACH,GAAI,KAAcyD,KAAO,KAAcC,GACrC,OAAO,EAET,IAAK,MAAMpI,KAAOmI,EAChB,IAAK,KAAmBA,EAAGnI,KAAS2I,EAAaR,EAAEnI,GAAMoI,EAAEpI,IACzD,OAAO,EAGX,MACF,KAAKiI,MACH,GAAIE,EAAEtJ,SAAWuJ,EAAEvJ,OACjB,OAAO,EAET,IAAK,IAAImJ,EAAI,EAAGA,EAAIG,EAAEtJ,OAAQmJ,IAC5B,IAAKW,EAAaR,EAAEH,GAAII,EAAEJ,IACxB,OAAO,EAGX,MACF,QACE,OAAO,EAEX,OAAO,I,wFCpIF,MAAMiB,EAAQC,KAAKD,MAEbE,GADOD,KAAKE,KACNF,KAAKC,KAGXE,GAFOH,KAAKI,KACJJ,KAAKK,MACLL,KAAKG,OAWbG,GAVON,KAAKO,KACNP,KAAKQ,IACJR,KAAKS,KAQN,CAACxB,EAAGC,IAAMD,EAAIC,GAQpBwB,EAAM,CAACzB,EAAGC,IAAMD,EAAIC,EAAID,EAAIC,EAQ5ByB,EAAM,CAAC1B,EAAGC,IAAMD,EAAIC,EAAID,EAAIC,EAmB5B0B,GAjBQC,OAAOC,MAETd,KAAKe,IASJf,KAAKgB,KAMKC,GAAW,IAANA,EAAUA,EAAI,EAAI,EAAIA,EAAI,I,6DC3CvCzF,OAAOC,OALtB,MAUMzE,EAAOwE,OAAOxE,KAkBdyC,EAAM,CAACyH,EAAK7L,KACvB,MAAM8L,EAAU,GAChB,IAAK,MAAMrK,KAAOoK,EAChBC,EAAQjK,KAAK7B,EAAE6L,EAAIpK,GAAMA,IAE3B,OAAOqK,GAOIxL,EAASuL,GAAOlK,EAAKkK,GAAKvL,OAqC1ByL,EAAc,CAACF,EAAKpK,IAAQ0E,OAAO0B,UAAUmE,eAAeC,KAAKJ,EAAKpK,GAOtEkI,EAAY,CAACC,EAAGC,IAAMD,IAAMC,GAAMvJ,EAAOsJ,KAAOtJ,EAAOuJ,IAvB/C,EAACgC,EAAK7L,KACzB,IAAK,MAAMyB,KAAOoK,EAChB,IAAK7L,EAAE6L,EAAIpK,GAAMA,GACf,OAAO,EAGX,OAAO,GAiBiEqI,CAAMF,GAAG,CAACsC,EAAKzK,UAAiBkD,IAARuH,GAAqBH,EAAYlC,EAAGpI,KAASoI,EAAEpI,KAASyK,K,0ICvDnJ,MAAMC,UAAkB,IAI7BlN,YAAa0I,GACX7G,QACA5B,KAAKyI,IAAMA,EAIXzI,KAAKkN,SAAWzE,EAAIyE,SAKpBlN,KAAKmN,OAAS,IAAIrH,IAIlB9F,KAAK6G,KAAO,IAAIf,IAChB9F,KAAKoN,eAAqCC,aAAY,KACpD,MAAMC,EAAM,OACiB,OAAzBtN,KAAKuN,iBAA6BC,MAAuBF,EAA2CtN,KAAK6G,KAAKnE,IAAI1C,KAAKkN,UAAWO,aAEpIzN,KAAK0N,cAAc1N,KAAKuN,iBAK1B,MAAMI,EAAS,GACf3N,KAAK6G,KAAKvE,SAAQ,CAACuE,EAAM+G,KACnBA,IAAa5N,KAAKkN,UAzDC,KAyD8BI,EAAMzG,EAAK4G,aAAezN,KAAKmN,OAAO/I,IAAIwJ,IAC7FD,EAAOhL,KAAKiL,MAGZD,EAAOvM,OAAS,GAClByM,EAAsB7N,KAAM2N,EAAQ,aAErC,KAAWH,MACd/E,EAAIqF,GAAG,WAAW,KAChB9N,KAAKiB,aAEPjB,KAAK0N,cAAc,IAGrBzM,UACEjB,KAAKkC,KAAK,UAAW,CAAClC,OACtBA,KAAK0N,cAAc,MACnB9L,MAAMX,UACN8M,cAAc/N,KAAKoN,gBAMrBG,gBACE,OAAOvN,KAAKmN,OAAOzK,IAAI1C,KAAKkN,WAAa,KAM3CQ,cAAeM,GACb,MAAMd,EAAWlN,KAAKkN,SAChBe,EAAgBjO,KAAK6G,KAAKnE,IAAIwK,GAC9BgB,OAA0BzI,IAAlBwI,EAA8B,EAAIA,EAAcC,MAAQ,EAChEC,EAAYnO,KAAKmN,OAAOzK,IAAIwK,GACpB,OAAVc,EACFhO,KAAKmN,OAAO5J,OAAO2J,GAEnBlN,KAAKmN,OAAO9I,IAAI6I,EAAUc,GAE5BhO,KAAK6G,KAAKxC,IAAI6I,EAAU,CACtBgB,MAAAA,EACAT,YAAa,SAEf,MAAM1J,EAAQ,GACRqK,EAAU,GACVC,EAAkB,GAClBC,EAAU,GACF,OAAVN,EACFM,EAAQ3L,KAAKuK,GACS,MAAbiB,EACI,MAATH,GACFjK,EAAMpB,KAAKuK,IAGbkB,EAAQzL,KAAKuK,GACR,KAAeiB,EAAWH,IAC7BK,EAAgB1L,KAAKuK,KAGrBnJ,EAAM3C,OAAS,GAAKiN,EAAgBjN,OAAS,GAAKkN,EAAQlN,OAAS,IACrEpB,KAAKkC,KAAK,SAAU,CAAC,CAAE6B,MAAAA,EAAOqK,QAASC,EAAiBC,QAAAA,GAAW,UAErEtO,KAAKkC,KAAK,SAAU,CAAC,CAAE6B,MAAAA,EAAOqK,QAAAA,EAASE,QAAAA,GAAW,UAOpDC,mBAAoBC,EAAOnL,GACzB,MAAM2K,EAAQhO,KAAKuN,gBACL,OAAVS,GACFhO,KAAK0N,cAAc,IACdM,EACH,CAACQ,GAAQnL,IAQfoL,YACE,OAAOzO,KAAKmN,QAYT,MAAMU,EAAwB,CAACnN,EAAWgO,EAASC,KACxD,MAAML,EAAU,GAChB,IAAK,IAAI/D,EAAI,EAAGA,EAAImE,EAAQtN,OAAQmJ,IAAK,CACvC,MAAM2C,EAAWwB,EAAQnE,GACzB,GAAI7J,EAAUyM,OAAO/I,IAAI8I,GAAW,CAElC,GADAxM,EAAUyM,OAAO5J,OAAO2J,GACpBA,IAAaxM,EAAUwM,SAAU,CACnC,MAAM0B,EAA0ClO,EAAUmG,KAAKnE,IAAIwK,GACnExM,EAAUmG,KAAKxC,IAAI6I,EAAU,CAC3BgB,MAAOU,EAAQV,MAAQ,EACvBT,YAAa,SAGjBa,EAAQ3L,KAAKuK,IAGboB,EAAQlN,OAAS,IACnBV,EAAUwB,KAAK,SAAU,CAAC,CAAE6B,MAAO,GAAIqK,QAAS,GAAIE,QAAAA,GAAWK,IAC/DjO,EAAUwB,KAAK,SAAU,CAAC,CAAE6B,MAAO,GAAIqK,QAAS,GAAIE,QAAAA,GAAWK,MAStDE,EAAwB,CAACnO,EAAWgO,EAASvB,EAASzM,EAAUyM,UAC3E,MAAM2B,EAAMJ,EAAQtN,OACd2N,EAAU,OAChB,KAAsBA,EAASD,GAC/B,IAAK,IAAIvE,EAAI,EAAGA,EAAIuE,EAAKvE,IAAK,CAC5B,MAAM2C,EAAWwB,EAAQnE,GACnByD,EAAQb,EAAOzK,IAAIwK,IAAa,KAChCgB,EAAwCxN,EAAUmG,KAAKnE,IAAIwK,GAAWgB,MAC5E,KAAsBa,EAAS7B,GAC/B,KAAsB6B,EAASb,GAC/B,KAAwBa,EAASpP,KAAKE,UAAUmO,IAElD,OAAO,KAAsBe,IAmClBC,EAAuB,CAACtO,EAAWuO,EAAQN,KACtD,MAAMO,EAAU,KAAuBD,GACjCE,EAAY,OACZpL,EAAQ,GACRqK,EAAU,GACVC,EAAkB,GAClBC,EAAU,GACVQ,EAAM,KAAqBI,GACjC,IAAK,IAAI3E,EAAI,EAAGA,EAAIuE,EAAKvE,IAAK,CAC5B,MAAM2C,EAAW,KAAqBgC,GACtC,IAAIhB,EAAQ,KAAqBgB,GACjC,MAAMlB,EAAQrO,KAAKC,MAAM,KAAuBsP,IAC1CE,EAAa1O,EAAUmG,KAAKnE,IAAIwK,GAChCiB,EAAYzN,EAAUyM,OAAOzK,IAAIwK,GACjCmC,OAA2B5J,IAAf2J,EAA2B,EAAIA,EAAWlB,OACxDmB,EAAYnB,GAAUmB,IAAcnB,GAAmB,OAAVF,GAAkBtN,EAAUyM,OAAO/I,IAAI8I,MACxE,OAAVc,EAEEd,IAAaxM,EAAUwM,UAAyC,MAA7BxM,EAAU6M,gBAG/CW,IAEAxN,EAAUyM,OAAO5J,OAAO2J,GAG1BxM,EAAUyM,OAAO9I,IAAI6I,EAAUc,GAEjCtN,EAAUmG,KAAKxC,IAAI6I,EAAU,CAC3BgB,MAAAA,EACAT,YAAa0B,SAEI1J,IAAf2J,GAAsC,OAAVpB,EAC9BjK,EAAMpB,KAAKuK,QACazH,IAAf2J,GAAsC,OAAVpB,EACrCM,EAAQ3L,KAAKuK,GACM,OAAVc,IACJ,KAAeA,EAAOG,IACzBE,EAAgB1L,KAAKuK,GAEvBkB,EAAQzL,KAAKuK,MAIfnJ,EAAM3C,OAAS,GAAKiN,EAAgBjN,OAAS,GAAKkN,EAAQlN,OAAS,IACrEV,EAAUwB,KAAK,SAAU,CAAC,CACxB6B,MAAAA,EAAOqK,QAASC,EAAiBC,QAAAA,GAChCK,KAED5K,EAAM3C,OAAS,GAAKgN,EAAQhN,OAAS,GAAKkN,EAAQlN,OAAS,IAC7DV,EAAUwB,KAAK,SAAU,CAAC,CACxB6B,MAAAA,EAAOqK,QAAAA,EAASE,QAAAA,GACfK","sources":["webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/@jupyterlab/shared-models/lib/ymodels.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/@jupyterlab/shared-models/lib/utils.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/lib0/array.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/lib0/function.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/lib0/math.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/lib0/object.js","webpack://_JUPYTERLAB.CORE_OUTPUT/../../node_modules/y-protocols/awareness.js"],"sourcesContent":["/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nimport { UUID } from '@lumino/coreutils';\nimport { Signal } from '@lumino/signaling';\nimport { Awareness } from 'y-protocols/awareness';\nimport * as Y from 'yjs';\nconst deepCopy = (o) => JSON.parse(JSON.stringify(o));\nexport class YDocument {\n    constructor() {\n        this.isDisposed = false;\n        this.ydoc = new Y.Doc();\n        this.source = this.ydoc.getText('source');\n        this.ystate = this.ydoc.getMap('state');\n        this.undoManager = new Y.UndoManager([this.source], {\n            trackedOrigins: new Set([this])\n        });\n        this.awareness = new Awareness(this.ydoc);\n        this._changed = new Signal(this);\n    }\n    /**\n     * Perform a transaction. While the function f is called, all changes to the shared\n     * document are bundled into a single event.\n     */\n    transact(f, undoable = true) {\n        this.ydoc.transact(f, undoable ? this : null);\n    }\n    /**\n     * Dispose of the resources.\n     */\n    dispose() {\n        this.isDisposed = true;\n        this.ydoc.destroy();\n    }\n    /**\n     * Whether the object can undo changes.\n     */\n    canUndo() {\n        return this.undoManager.undoStack.length > 0;\n    }\n    /**\n     * Whether the object can redo changes.\n     */\n    canRedo() {\n        return this.undoManager.redoStack.length > 0;\n    }\n    /**\n     * Undo an operation.\n     */\n    undo() {\n        this.undoManager.undo();\n    }\n    /**\n     * Redo an operation.\n     */\n    redo() {\n        this.undoManager.redo();\n    }\n    /**\n     * Clear the change stack.\n     */\n    clearUndoHistory() {\n        this.undoManager.clear();\n    }\n    /**\n     * The changed signal.\n     */\n    get changed() {\n        return this._changed;\n    }\n}\nexport class YFile extends YDocument {\n    constructor() {\n        super();\n        /**\n         * Handle a change to the ymodel.\n         */\n        this._modelObserver = (event) => {\n            const changes = {};\n            changes.sourceChange = event.changes.delta;\n            this._changed.emit(changes);\n        };\n        /**\n         * Handle a change to the ystate.\n         */\n        this._onStateChanged = (event) => {\n            const stateChange = [];\n            event.keysChanged.forEach(key => {\n                const change = event.changes.keys.get(key);\n                stateChange.push({\n                    name: key,\n                    oldValue: (change === null || change === void 0 ? void 0 : change.oldValue) ? change.oldValue : 0,\n                    newValue: this.ystate.get(key)\n                });\n            });\n            this._changed.emit({ stateChange });\n        };\n        this.ysource = this.ydoc.getText('source');\n        this.ysource.observe(this._modelObserver);\n        this.ystate.observe(this._onStateChanged);\n    }\n    /**\n     * Dispose of the resources.\n     */\n    dispose() {\n        this.ysource.unobserve(this._modelObserver);\n        this.ystate.unobserve(this._onStateChanged);\n    }\n    static create() {\n        return new YFile();\n    }\n    /**\n     * Gets cell's source.\n     *\n     * @returns Cell's source.\n     */\n    getSource() {\n        return this.ysource.toString();\n    }\n    /**\n     * Sets cell's source.\n     *\n     * @param value: New source.\n     */\n    setSource(value) {\n        this.transact(() => {\n            const ytext = this.ysource;\n            ytext.delete(0, ytext.length);\n            ytext.insert(0, value);\n        });\n    }\n    /**\n     * Replace content from `start' to `end` with `value`.\n     *\n     * @param start: The start index of the range to replace (inclusive).\n     *\n     * @param end: The end index of the range to replace (exclusive).\n     *\n     * @param value: New source (optional).\n     */\n    updateSource(start, end, value = '') {\n        this.transact(() => {\n            const ysource = this.ysource;\n            // insert and then delete.\n            // This ensures that the cursor position is adjusted after the replaced content.\n            ysource.insert(start, value);\n            ysource.delete(start + value.length, end - start);\n        });\n    }\n}\n/**\n * Shared implementation of the Shared Document types.\n *\n * Shared cells can be inserted into a SharedNotebook.\n * Shared cells only start emitting events when they are connected to a SharedNotebook.\n *\n * \"Standalone\" cells must not be inserted into a (Shared)Notebook.\n * Standalone cells emit events immediately after they have been created, but they must not\n * be included into a (Shared)Notebook.\n */\nexport class YNotebook extends YDocument {\n    constructor(options) {\n        super();\n        /**\n         * Handle a change to the list of cells.\n         */\n        this._onYCellsChanged = (event) => {\n            // update the type⇔cell mapping by iterating through the added/removed types\n            event.changes.added.forEach(item => {\n                const type = item.content.type;\n                if (!this._ycellMapping.has(type)) {\n                    this._ycellMapping.set(type, createCellFromType(type));\n                }\n                const cell = this._ycellMapping.get(type);\n                cell._notebook = this;\n                if (!this.disableDocumentWideUndoRedo) {\n                    cell._undoManager = this.undoManager;\n                }\n                else {\n                    cell._undoManager = new Y.UndoManager([cell.ymodel], {});\n                }\n            });\n            event.changes.deleted.forEach(item => {\n                const type = item.content.type;\n                const model = this._ycellMapping.get(type);\n                if (model) {\n                    model.dispose();\n                    this._ycellMapping.delete(type);\n                }\n            });\n            let index = 0;\n            // this reflects the event.changes.delta, but replaces the content of delta.insert with ycells\n            const cellsChange = [];\n            event.changes.delta.forEach((d) => {\n                if (d.insert != null) {\n                    const insertedCells = d.insert.map((ycell) => this._ycellMapping.get(ycell));\n                    cellsChange.push({ insert: insertedCells });\n                    this.cells.splice(index, 0, ...insertedCells);\n                    index += d.insert.length;\n                }\n                else if (d.delete != null) {\n                    cellsChange.push(d);\n                    this.cells.splice(index, d.delete);\n                }\n                else if (d.retain != null) {\n                    cellsChange.push(d);\n                    index += d.retain;\n                }\n            });\n            this._changed.emit({\n                cellsChange: cellsChange\n            });\n        };\n        /**\n         * Handle a change to the ystate.\n         */\n        this._onMetadataChanged = (event) => {\n            if (event.keysChanged.has('metadata')) {\n                const change = event.changes.keys.get('metadata');\n                const metadataChange = {\n                    oldValue: (change === null || change === void 0 ? void 0 : change.oldValue) ? change.oldValue : undefined,\n                    newValue: this.getMetadata()\n                };\n                this._changed.emit({ metadataChange });\n            }\n        };\n        /**\n         * Handle a change to the ystate.\n         */\n        this._onStateChanged = (event) => {\n            const stateChange = [];\n            event.keysChanged.forEach(key => {\n                const change = event.changes.keys.get(key);\n                stateChange.push({\n                    name: key,\n                    oldValue: (change === null || change === void 0 ? void 0 : change.oldValue) ? change.oldValue : 0,\n                    newValue: this.ystate.get(key)\n                });\n            });\n            this._changed.emit({ stateChange });\n        };\n        this.ycells = this.ydoc.getArray('cells');\n        this.ymeta = this.ydoc.getMap('meta');\n        this.ymodel = this.ydoc.getMap('model');\n        this.undoManager = new Y.UndoManager([this.ycells], {\n            trackedOrigins: new Set([this])\n        });\n        this._ycellMapping = new Map();\n        this._disableDocumentWideUndoRedo = options.disableDocumentWideUndoRedo;\n        this.ycells.observe(this._onYCellsChanged);\n        this.cells = this.ycells.toArray().map(ycell => {\n            if (!this._ycellMapping.has(ycell)) {\n                this._ycellMapping.set(ycell, createCellFromType(ycell));\n            }\n            return this._ycellMapping.get(ycell);\n        });\n        this.ymeta.observe(this._onMetadataChanged);\n        this.ystate.observe(this._onStateChanged);\n    }\n    get nbformat() {\n        return this.ystate.get('nbformat');\n    }\n    set nbformat(value) {\n        this.transact(() => {\n            this.ystate.set('nbformat', value);\n        }, false);\n    }\n    get nbformat_minor() {\n        return this.ystate.get('nbformatMinor');\n    }\n    set nbformat_minor(value) {\n        this.transact(() => {\n            this.ystate.set('nbformatMinor', value);\n        }, false);\n    }\n    /**\n     * Dispose of the resources.\n     */\n    dispose() {\n        this.ycells.unobserve(this._onYCellsChanged);\n        this.ymeta.unobserve(this._onMetadataChanged);\n        this.ystate.unobserve(this._onStateChanged);\n    }\n    /**\n     * Get a shared cell by index.\n     *\n     * @param index: Cell's position.\n     *\n     * @returns The requested shared cell.\n     */\n    getCell(index) {\n        return this.cells[index];\n    }\n    /**\n     * Insert a shared cell into a specific position.\n     *\n     * @param index: Cell's position.\n     *\n     * @param cell: Cell to insert.\n     */\n    insertCell(index, cell) {\n        this.insertCells(index, [cell]);\n    }\n    /**\n     * Insert a list of shared cells into a specific position.\n     *\n     * @param index: Position to insert the cells.\n     *\n     * @param cells: Array of shared cells to insert.\n     */\n    insertCells(index, cells) {\n        cells.forEach(cell => {\n            this._ycellMapping.set(cell.ymodel, cell);\n            if (!this.disableDocumentWideUndoRedo) {\n                cell.undoManager = this.undoManager;\n            }\n        });\n        this.transact(() => {\n            this.ycells.insert(index, cells.map(cell => cell.ymodel));\n        });\n    }\n    /**\n     * Move a cell.\n     *\n     * @param fromIndex: Index of the cell to move.\n     *\n     * @param toIndex: New position of the cell.\n     */\n    moveCell(fromIndex, toIndex) {\n        this.transact(() => {\n            const fromCell = this.getCell(fromIndex).clone();\n            this.deleteCell(fromIndex);\n            this.insertCell(toIndex, fromCell);\n        });\n    }\n    /**\n     * Remove a cell.\n     *\n     * @param index: Index of the cell to remove.\n     */\n    deleteCell(index) {\n        this.deleteCellRange(index, index + 1);\n    }\n    /**\n     * Remove a range of cells.\n     *\n     * @param from: The start index of the range to remove (inclusive).\n     *\n     * @param to: The end index of the range to remove (exclusive).\n     */\n    deleteCellRange(from, to) {\n        this.transact(() => {\n            this.ycells.delete(from, to - from);\n        });\n    }\n    /**\n     * Returns the metadata associated with the notebook.\n     *\n     * @returns Notebook's metadata.\n     */\n    getMetadata() {\n        const meta = this.ymeta.get('metadata');\n        return meta ? deepCopy(meta) : { orig_nbformat: 4 };\n    }\n    /**\n     * Sets the metadata associated with the notebook.\n     *\n     * @param metadata: Notebook's metadata.\n     */\n    setMetadata(value) {\n        this.ymeta.set('metadata', deepCopy(value));\n    }\n    /**\n     * Updates the metadata associated with the notebook.\n     *\n     * @param value: Metadata's attribute to update.\n     */\n    updateMetadata(value) {\n        // TODO: Maybe modify only attributes instead of replacing the whole metadata?\n        this.ymeta.set('metadata', Object.assign({}, this.getMetadata(), value));\n    }\n    /**\n     * Create a new YNotebook.\n     */\n    static create(disableDocumentWideUndoRedo) {\n        return new YNotebook({ disableDocumentWideUndoRedo });\n    }\n    /**\n     * Wether the the undo/redo logic should be\n     * considered on the full document across all cells.\n     *\n     * @return The disableDocumentWideUndoRedo setting.\n     */\n    get disableDocumentWideUndoRedo() {\n        return this._disableDocumentWideUndoRedo;\n    }\n}\n/**\n * Create a new shared cell given the type.\n */\nexport const createCellFromType = (type) => {\n    switch (type.get('cell_type')) {\n        case 'code':\n            return new YCodeCell(type);\n        case 'markdown':\n            return new YMarkdownCell(type);\n        case 'raw':\n            return new YRawCell(type);\n        default:\n            throw new Error('Found unknown cell type');\n    }\n};\n/**\n * Create a new standalone cell given the type.\n */\nexport const createStandaloneCell = (cellType, id) => {\n    switch (cellType) {\n        case 'markdown':\n            return YMarkdownCell.createStandalone(id);\n        case 'code':\n            return YCodeCell.createStandalone(id);\n        default:\n            // raw\n            return YRawCell.createStandalone(id);\n    }\n};\nexport class YBaseCell {\n    constructor(ymodel) {\n        /**\n         * The notebook that this cell belongs to.\n         */\n        this._notebook = null;\n        /**\n         * Whether the cell is standalone or not.\n         *\n         * If the cell is standalone. It cannot be\n         * inserted into a YNotebook because the Yjs model is already\n         * attached to an anonymous Y.Doc instance.\n         */\n        this.isStandalone = false;\n        /**\n         * Handle a change to the ymodel.\n         */\n        this._modelObserver = (events) => {\n            const changes = {};\n            const sourceEvent = events.find(event => event.target === this.ymodel.get('source'));\n            if (sourceEvent) {\n                changes.sourceChange = sourceEvent.changes.delta;\n            }\n            const outputEvent = events.find(event => event.target === this.ymodel.get('outputs'));\n            if (outputEvent) {\n                changes.outputsChange = outputEvent.changes.delta;\n            }\n            const modelEvent = events.find(event => event.target === this.ymodel);\n            if (modelEvent && modelEvent.keysChanged.has('metadata')) {\n                const change = modelEvent.changes.keys.get('metadata');\n                changes.metadataChange = {\n                    oldValue: (change === null || change === void 0 ? void 0 : change.oldValue) ? change.oldValue : undefined,\n                    newValue: this.getMetadata()\n                };\n            }\n            if (modelEvent && modelEvent.keysChanged.has('execution_count')) {\n                const change = modelEvent.changes.keys.get('execution_count');\n                changes.executionCountChange = {\n                    oldValue: change.oldValue,\n                    newValue: this.ymodel.get('execution_count')\n                };\n            }\n            // The model allows us to replace the complete source with a new string. We express this in the Delta format\n            // as a replace of the complete string.\n            const ysource = this.ymodel.get('source');\n            if (modelEvent && modelEvent.keysChanged.has('source')) {\n                changes.sourceChange = [\n                    { delete: this._prevSourceLength },\n                    { insert: ysource.toString() }\n                ];\n            }\n            this._prevSourceLength = ysource.length;\n            this._changed.emit(changes);\n        };\n        this.isDisposed = false;\n        this._undoManager = null;\n        this._changed = new Signal(this);\n        this.ymodel = ymodel;\n        const ysource = ymodel.get('source');\n        this._prevSourceLength = ysource ? ysource.length : 0;\n        this.ymodel.observeDeep(this._modelObserver);\n    }\n    get ysource() {\n        return this.ymodel.get('source');\n    }\n    get awareness() {\n        var _a;\n        return ((_a = this.notebook) === null || _a === void 0 ? void 0 : _a.awareness) || null;\n    }\n    /**\n     * Perform a transaction. While the function f is called, all changes to the shared\n     * document are bundled into a single event.\n     */\n    transact(f, undoable = true) {\n        this.notebook && undoable\n            ? this.notebook.transact(f)\n            : this.ymodel.doc.transact(f, this);\n    }\n    /**\n     * The notebook that this cell belongs to.\n     */\n    get undoManager() {\n        var _a;\n        if (!this.notebook) {\n            return this._undoManager;\n        }\n        return ((_a = this.notebook) === null || _a === void 0 ? void 0 : _a.disableDocumentWideUndoRedo) ? this._undoManager\n            : this.notebook.undoManager;\n    }\n    /**\n     * Set the undoManager when adding new cells.\n     */\n    set undoManager(undoManager) {\n        this._undoManager = undoManager;\n    }\n    /**\n     * Undo an operation.\n     */\n    undo() {\n        var _a;\n        (_a = this.undoManager) === null || _a === void 0 ? void 0 : _a.undo();\n    }\n    /**\n     * Redo an operation.\n     */\n    redo() {\n        var _a;\n        (_a = this.undoManager) === null || _a === void 0 ? void 0 : _a.redo();\n    }\n    /**\n     * Whether the object can undo changes.\n     */\n    canUndo() {\n        return !!this.undoManager && this.undoManager.undoStack.length > 0;\n    }\n    /**\n     * Whether the object can redo changes.\n     */\n    canRedo() {\n        return !!this.undoManager && this.undoManager.redoStack.length > 0;\n    }\n    /**\n     * Clear the change stack.\n     */\n    clearUndoHistory() {\n        var _a;\n        (_a = this.undoManager) === null || _a === void 0 ? void 0 : _a.clear();\n    }\n    /**\n     * The notebook that this cell belongs to.\n     */\n    get notebook() {\n        return this._notebook;\n    }\n    /**\n     * Create a new YRawCell that can be inserted into a YNotebook\n     */\n    static create(id = UUID.uuid4()) {\n        const ymodel = new Y.Map();\n        const ysource = new Y.Text();\n        ymodel.set('source', ysource);\n        ymodel.set('metadata', {});\n        ymodel.set('cell_type', this.prototype.cell_type);\n        ymodel.set('id', id);\n        return new this(ymodel);\n    }\n    /**\n     * Create a new YRawCell that works standalone. It cannot be\n     * inserted into a YNotebook because the Yjs model is already\n     * attached to an anonymous Y.Doc instance.\n     */\n    static createStandalone(id) {\n        const cell = this.create(id);\n        cell.isStandalone = true;\n        new Y.Doc().getArray().insert(0, [cell.ymodel]);\n        cell._undoManager = new Y.UndoManager([cell.ymodel], {\n            trackedOrigins: new Set([cell])\n        });\n        return cell;\n    }\n    /**\n     * Clone the cell.\n     *\n     * @todo clone should only be available in the specific implementations i.e. ISharedCodeCell\n     */\n    clone() {\n        const ymodel = new Y.Map();\n        const ysource = new Y.Text(this.getSource());\n        ymodel.set('source', ysource);\n        ymodel.set('metadata', this.getMetadata());\n        ymodel.set('cell_type', this.cell_type);\n        ymodel.set('id', this.getId());\n        const Self = this.constructor;\n        const clone = new Self(ymodel);\n        // TODO The assignment of the undoManager does not work for a clone.\n        // See https://github.com/jupyterlab/jupyterlab/issues/11035\n        clone._undoManager = this.undoManager;\n        return clone;\n    }\n    /**\n     * The changed signal.\n     */\n    get changed() {\n        return this._changed;\n    }\n    /**\n     * Dispose of the resources.\n     */\n    dispose() {\n        this.ymodel.unobserveDeep(this._modelObserver);\n    }\n    /**\n     * Gets the cell attachments.\n     *\n     * @returns The cell attachments.\n     */\n    getAttachments() {\n        return this.ymodel.get('attachments');\n    }\n    /**\n     * Sets the cell attachments\n     *\n     * @param attachments: The cell attachments.\n     */\n    setAttachments(attachments) {\n        this.transact(() => {\n            if (attachments == null) {\n                this.ymodel.set('attachments', attachments);\n            }\n            else {\n                this.ymodel.delete('attachments');\n            }\n        });\n    }\n    /**\n     * Get cell id.\n     *\n     * @returns Cell id\n     */\n    getId() {\n        return this.ymodel.get('id');\n    }\n    /**\n     * Gets cell's source.\n     *\n     * @returns Cell's source.\n     */\n    getSource() {\n        return this.ymodel.get('source').toString();\n    }\n    /**\n     * Sets cell's source.\n     *\n     * @param value: New source.\n     */\n    setSource(value) {\n        const ytext = this.ymodel.get('source');\n        this.transact(() => {\n            ytext.delete(0, ytext.length);\n            ytext.insert(0, value);\n        });\n        // @todo Do we need proper replace semantic? This leads to issues in editor bindings because they don't switch source.\n        // this.ymodel.set('source', new Y.Text(value));\n    }\n    /**\n     * Replace content from `start' to `end` with `value`.\n     *\n     * @param start: The start index of the range to replace (inclusive).\n     *\n     * @param end: The end index of the range to replace (exclusive).\n     *\n     * @param value: New source (optional).\n     */\n    updateSource(start, end, value = '') {\n        this.transact(() => {\n            const ysource = this.ysource;\n            // insert and then delete.\n            // This ensures that the cursor position is adjusted after the replaced content.\n            ysource.insert(start, value);\n            ysource.delete(start + value.length, end - start);\n        });\n    }\n    /**\n     * The type of the cell.\n     */\n    get cell_type() {\n        throw new Error('A YBaseCell must not be constructed');\n    }\n    /**\n     * Returns the metadata associated with the notebook.\n     *\n     * @returns Notebook's metadata.\n     */\n    getMetadata() {\n        return deepCopy(this.ymodel.get('metadata'));\n    }\n    /**\n     * Sets the metadata associated with the notebook.\n     *\n     * @param metadata: Notebook's metadata.\n     */\n    setMetadata(value) {\n        this.transact(() => {\n            this.ymodel.set('metadata', deepCopy(value));\n        });\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return {\n            id: this.getId(),\n            cell_type: this.cell_type,\n            source: this.getSource(),\n            metadata: this.getMetadata()\n        };\n    }\n}\nexport class YCodeCell extends YBaseCell {\n    /**\n     * The type of the cell.\n     */\n    get cell_type() {\n        return 'code';\n    }\n    /**\n     * The code cell's prompt number. Will be null if the cell has not been run.\n     */\n    get execution_count() {\n        return this.ymodel.get('execution_count');\n    }\n    /**\n     * The code cell's prompt number. Will be null if the cell has not been run.\n     */\n    set execution_count(count) {\n        this.transact(() => {\n            this.ymodel.set('execution_count', count);\n        });\n    }\n    /**\n     * Execution, display, or stream outputs.\n     */\n    getOutputs() {\n        return deepCopy(this.ymodel.get('outputs').toArray());\n    }\n    /**\n     * Replace all outputs.\n     */\n    setOutputs(outputs) {\n        const youtputs = this.ymodel.get('outputs');\n        this.transact(() => {\n            youtputs.delete(0, youtputs.length);\n            youtputs.insert(0, outputs);\n        }, false);\n    }\n    /**\n     * Replace content from `start' to `end` with `outputs`.\n     *\n     * @param start: The start index of the range to replace (inclusive).\n     *\n     * @param end: The end index of the range to replace (exclusive).\n     *\n     * @param outputs: New outputs (optional).\n     */\n    updateOutputs(start, end, outputs = []) {\n        const youtputs = this.ymodel.get('outputs');\n        const fin = end < youtputs.length ? end - start : youtputs.length - start;\n        this.transact(() => {\n            youtputs.delete(start, fin);\n            youtputs.insert(start, outputs);\n        }, false);\n    }\n    /**\n     * Create a new YCodeCell that can be inserted into a YNotebook\n     */\n    static create(id) {\n        const cell = super.create(id);\n        cell.ymodel.set('execution_count', 0); // for some default value\n        cell.ymodel.set('outputs', new Y.Array());\n        return cell;\n    }\n    /**\n     * Create a new YCodeCell that works standalone. It cannot be\n     * inserted into a YNotebook because the Yjs model is already\n     * attached to an anonymous Y.Doc instance.\n     */\n    static createStandalone(id) {\n        const cell = super.createStandalone(id);\n        cell.ymodel.set('execution_count', null); // for some default value\n        cell.ymodel.set('outputs', new Y.Array());\n        return cell;\n    }\n    /**\n     * Create a new YCodeCell that can be inserted into a YNotebook\n     *\n     * @todo clone should only be available in the specific implementations i.e. ISharedCodeCell\n     */\n    clone() {\n        const cell = super.clone();\n        const youtputs = new Y.Array();\n        youtputs.insert(0, this.getOutputs());\n        cell.ymodel.set('execution_count', this.execution_count); // for some default value\n        cell.ymodel.set('outputs', youtputs);\n        return cell;\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return {\n            id: this.getId(),\n            cell_type: 'code',\n            source: this.getSource(),\n            metadata: this.getMetadata(),\n            outputs: this.getOutputs(),\n            execution_count: this.execution_count\n        };\n    }\n}\nexport class YRawCell extends YBaseCell {\n    /**\n     * Create a new YRawCell that can be inserted into a YNotebook\n     */\n    static create(id) {\n        return super.create(id);\n    }\n    /**\n     * Create a new YRawCell that works standalone. It cannot be\n     * inserted into a YNotebook because the Yjs model is already\n     * attached to an anonymous Y.Doc instance.\n     */\n    static createStandalone(id) {\n        return super.createStandalone(id);\n    }\n    /**\n     * String identifying the type of cell.\n     */\n    get cell_type() {\n        return 'raw';\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return {\n            id: this.getId(),\n            cell_type: 'raw',\n            source: this.getSource(),\n            metadata: this.getMetadata(),\n            attachments: this.getAttachments()\n        };\n    }\n}\nexport class YMarkdownCell extends YBaseCell {\n    /**\n     * Create a new YMarkdownCell that can be inserted into a YNotebook\n     */\n    static create(id) {\n        return super.create(id);\n    }\n    /**\n     * Create a new YMarkdownCell that works standalone. It cannot be\n     * inserted into a YNotebook because the Yjs model is already\n     * attached to an anonymous Y.Doc instance.\n     */\n    static createStandalone(id) {\n        return super.createStandalone(id);\n    }\n    /**\n     * String identifying the type of cell.\n     */\n    get cell_type() {\n        return 'markdown';\n    }\n    /**\n     * Serialize the model to JSON.\n     */\n    toJSON() {\n        return {\n            id: this.getId(),\n            cell_type: 'markdown',\n            source: this.getSource(),\n            metadata: this.getMetadata(),\n            attachments: this.getAttachments()\n        };\n    }\n}\nexport default YNotebook;\n//# sourceMappingURL=ymodels.js.map","/* -----------------------------------------------------------------------------\n| Copyright (c) Jupyter Development Team.\n| Distributed under the terms of the Modified BSD License.\n|----------------------------------------------------------------------------*/\nexport function convertYMapEventToMapChange(event) {\n    let changes = new Map();\n    event.changes.keys.forEach((event, key) => {\n        changes.set(key, {\n            action: event.action,\n            oldValue: event.oldValue,\n            newValue: this.ymeta.get(key)\n        });\n    });\n    return changes;\n}\n/**\n * Creates a mutual exclude function with the following property:\n *\n * ```js\n * const mutex = createMutex()\n * mutex(() => {\n *   // This function is immediately executed\n *   mutex(() => {\n *     // This function is not executed, as the mutex is already active.\n *   })\n * })\n * ```\n */\nexport const createMutex = () => {\n    let token = true;\n    return (f) => {\n        if (token) {\n            token = false;\n            try {\n                f();\n            }\n            finally {\n                token = true;\n            }\n        }\n    };\n};\n//# sourceMappingURL=utils.js.map","/**\n * Utility module to work with Arrays.\n *\n * @module array\n */\n\n/**\n * Return the last element of an array. The element must exist\n *\n * @template L\n * @param {Array<L>} arr\n * @return {L}\n */\nexport const last = arr => arr[arr.length - 1]\n\n/**\n * @template C\n * @return {Array<C>}\n */\nexport const create = () => /** @type {Array<C>} */ ([])\n\n/**\n * @template D\n * @param {Array<D>} a\n * @return {Array<D>}\n */\nexport const copy = a => /** @type {Array<D>} */ (a.slice())\n\n/**\n * Append elements from src to dest\n *\n * @template M\n * @param {Array<M>} dest\n * @param {Array<M>} src\n */\nexport const appendTo = (dest, src) => {\n  for (let i = 0; i < src.length; i++) {\n    dest.push(src[i])\n  }\n}\n\n/**\n * Transforms something array-like to an actual Array.\n *\n * @function\n * @template T\n * @param {ArrayLike<T>|Iterable<T>} arraylike\n * @return {T}\n */\nexport const from = Array.from\n\n/**\n * True iff condition holds on every element in the Array.\n *\n * @function\n * @template ITEM\n *\n * @param {Array<ITEM>} arr\n * @param {function(ITEM, number, Array<ITEM>):boolean} f\n * @return {boolean}\n */\nexport const every = (arr, f) => arr.every(f)\n\n/**\n * True iff condition holds on some element in the Array.\n *\n * @function\n * @template S\n * @param {Array<S>} arr\n * @param {function(S, number, Array<S>):boolean} f\n * @return {boolean}\n */\nexport const some = (arr, f) => arr.some(f)\n\n/**\n * @template ELEM\n *\n * @param {Array<ELEM>} a\n * @param {Array<ELEM>} b\n * @return {boolean}\n */\nexport const equalFlat = (a, b) => a.length === b.length && every(a, (item, index) => item === b[index])\n\n/**\n * @template ELEM\n * @param {Array<Array<ELEM>>} arr\n * @return {Array<ELEM>}\n */\nexport const flatten = arr => arr.reduce((acc, val) => acc.concat(val), [])\n","/**\n * Common functions and function call helpers.\n *\n * @module function\n */\n\nimport * as array from './array.js'\nimport * as object from './object.js'\n\n/**\n * Calls all functions in `fs` with args. Only throws after all functions were called.\n *\n * @param {Array<function>} fs\n * @param {Array<any>} args\n */\nexport const callAll = (fs, args, i = 0) => {\n  try {\n    for (; i < fs.length; i++) {\n      fs[i](...args)\n    }\n  } finally {\n    if (i < fs.length) {\n      callAll(fs, args, i + 1)\n    }\n  }\n}\n\nexport const nop = () => {}\n\n/**\n * @template T\n * @param {function():T} f\n * @return {T}\n */\nexport const apply = f => f()\n\n/**\n * @template A\n *\n * @param {A} a\n * @return {A}\n */\nexport const id = a => a\n\n/**\n * @template T\n *\n * @param {T} a\n * @param {T} b\n * @return {boolean}\n */\nexport const equalityStrict = (a, b) => a === b\n\n/**\n * @template T\n *\n * @param {Array<T>|object} a\n * @param {Array<T>|object} b\n * @return {boolean}\n */\nexport const equalityFlat = (a, b) => a === b || (a != null && b != null && a.constructor === b.constructor && ((a instanceof Array && array.equalFlat(a, /** @type {Array<T>} */ (b))) || (typeof a === 'object' && object.equalFlat(a, b))))\n\n/**\n * @param {any} a\n * @param {any} b\n * @return {boolean}\n */\nexport const equalityDeep = (a, b) => {\n  if (a == null || b == null) {\n    return equalityStrict(a, b)\n  }\n  if (a.constructor !== b.constructor) {\n    return false\n  }\n  if (a === b) {\n    return true\n  }\n  switch (a.constructor) {\n    case ArrayBuffer:\n      a = new Uint8Array(a)\n      b = new Uint8Array(b)\n    // eslint-disable-next-line no-fallthrough\n    case Uint8Array: {\n      if (a.byteLength !== b.byteLength) {\n        return false\n      }\n      for (let i = 0; i < a.length; i++) {\n        if (a[i] !== b[i]) {\n          return false\n        }\n      }\n      break\n    }\n    case Set: {\n      if (a.size !== b.size) {\n        return false\n      }\n      for (const value of a) {\n        if (!b.has(value)) {\n          return false\n        }\n      }\n      break\n    }\n    case Map: {\n      if (a.size !== b.size) {\n        return false\n      }\n      for (const key of a.keys()) {\n        if (!b.has(key) || !equalityDeep(a.get(key), b.get(key))) {\n          return false\n        }\n      }\n      break\n    }\n    case Object:\n      if (object.length(a) !== object.length(b)) {\n        return false\n      }\n      for (const key in a) {\n        if (!object.hasProperty(a, key) || !equalityDeep(a[key], b[key])) {\n          return false\n        }\n      }\n      break\n    case Array:\n      if (a.length !== b.length) {\n        return false\n      }\n      for (let i = 0; i < a.length; i++) {\n        if (!equalityDeep(a[i], b[i])) {\n          return false\n        }\n      }\n      break\n    default:\n      return false\n  }\n  return true\n}\n","/**\n * Common Math expressions.\n *\n * @module math\n */\n\nexport const floor = Math.floor\nexport const ceil = Math.ceil\nexport const abs = Math.abs\nexport const imul = Math.imul\nexport const round = Math.round\nexport const log10 = Math.log10\nexport const log2 = Math.log2\nexport const log = Math.log\nexport const sqrt = Math.sqrt\n\n/**\n * @function\n * @param {number} a\n * @param {number} b\n * @return {number} The sum of a and b\n */\nexport const add = (a, b) => a + b\n\n/**\n * @function\n * @param {number} a\n * @param {number} b\n * @return {number} The smaller element of a and b\n */\nexport const min = (a, b) => a < b ? a : b\n\n/**\n * @function\n * @param {number} a\n * @param {number} b\n * @return {number} The bigger element of a and b\n */\nexport const max = (a, b) => a > b ? a : b\n\nexport const isNaN = Number.isNaN\n\nexport const pow = Math.pow\n/**\n * Base 10 exponential function. Returns the value of 10 raised to the power of pow.\n *\n * @param {number} exp\n * @return {number}\n */\nexport const exp10 = exp => Math.pow(10, exp)\n\nexport const sign = Math.sign\n\n/**\n * @param {number} n\n * @return {boolean} Wether n is negative. This function also differentiates between -0 and +0\n */\nexport const isNegativeZero = n => n !== 0 ? n < 0 : 1 / n < 0\n","/**\n * Utility functions for working with EcmaScript objects.\n *\n * @module object\n */\n\n/**\n * @return {Object<string,any>} obj\n */\nexport const create = () => Object.create(null)\n\n/**\n * Object.assign\n */\nexport const assign = Object.assign\n\n/**\n * @param {Object<string,any>} obj\n */\nexport const keys = Object.keys\n\n/**\n * @param {Object<string,any>} obj\n * @param {function(any,string):any} f\n */\nexport const forEach = (obj, f) => {\n  for (const key in obj) {\n    f(obj[key], key)\n  }\n}\n\n/**\n * @template R\n * @param {Object<string,any>} obj\n * @param {function(any,string):R} f\n * @return {Array<R>}\n */\nexport const map = (obj, f) => {\n  const results = []\n  for (const key in obj) {\n    results.push(f(obj[key], key))\n  }\n  return results\n}\n\n/**\n * @param {Object<string,any>} obj\n * @return {number}\n */\nexport const length = obj => keys(obj).length\n\n/**\n * @param {Object<string,any>} obj\n * @param {function(any,string):boolean} f\n * @return {boolean}\n */\nexport const some = (obj, f) => {\n  for (const key in obj) {\n    if (f(obj[key], key)) {\n      return true\n    }\n  }\n  return false\n}\n\n/**\n * @param {Object<string,any>} obj\n * @param {function(any,string):boolean} f\n * @return {boolean}\n */\nexport const every = (obj, f) => {\n  for (const key in obj) {\n    if (!f(obj[key], key)) {\n      return false\n    }\n  }\n  return true\n}\n\n/**\n * Calls `Object.prototype.hasOwnProperty`.\n *\n * @param {any} obj\n * @param {string|symbol} key\n * @return {boolean}\n */\nexport const hasProperty = (obj, key) => Object.prototype.hasOwnProperty.call(obj, key)\n\n/**\n * @param {Object<string,any>} a\n * @param {Object<string,any>} b\n * @return {boolean}\n */\nexport const equalFlat = (a, b) => a === b || (length(a) === length(b) && every(a, (val, key) => (val !== undefined || hasProperty(b, key)) && b[key] === val))\n","/**\n * @module awareness-protocol\n */\n\nimport * as encoding from 'lib0/encoding'\nimport * as decoding from 'lib0/decoding'\nimport * as time from 'lib0/time'\nimport * as math from 'lib0/math'\nimport { Observable } from 'lib0/observable'\nimport * as f from 'lib0/function'\nimport * as Y from 'yjs' // eslint-disable-line\n\nexport const outdatedTimeout = 30000\n\n/**\n * @typedef {Object} MetaClientState\n * @property {number} MetaClientState.clock\n * @property {number} MetaClientState.lastUpdated unix timestamp\n */\n\n/**\n * The Awareness class implements a simple shared state protocol that can be used for non-persistent data like awareness information\n * (cursor, username, status, ..). Each client can update its own local state and listen to state changes of\n * remote clients. Every client may set a state of a remote peer to `null` to mark the client as offline.\n *\n * Each client is identified by a unique client id (something we borrow from `doc.clientID`). A client can override\n * its own state by propagating a message with an increasing timestamp (`clock`). If such a message is received, it is\n * applied if the known state of that client is older than the new state (`clock < newClock`). If a client thinks that\n * a remote client is offline, it may propagate a message with\n * `{ clock: currentClientClock, state: null, client: remoteClient }`. If such a\n * message is received, and the known clock of that client equals the received clock, it will override the state with `null`.\n *\n * Before a client disconnects, it should propagate a `null` state with an updated clock.\n *\n * Awareness states must be updated every 30 seconds. Otherwise the Awareness instance will delete the client state.\n *\n * @extends {Observable<string>}\n */\nexport class Awareness extends Observable {\n  /**\n   * @param {Y.Doc} doc\n   */\n  constructor (doc) {\n    super()\n    this.doc = doc\n    /**\n     * @type {number}\n     */\n    this.clientID = doc.clientID\n    /**\n     * Maps from client id to client state\n     * @type {Map<number, Object<string, any>>}\n     */\n    this.states = new Map()\n    /**\n     * @type {Map<number, MetaClientState>}\n     */\n    this.meta = new Map()\n    this._checkInterval = /** @type {any} */ (setInterval(() => {\n      const now = time.getUnixTime()\n      if (this.getLocalState() !== null && (outdatedTimeout / 2 <= now - /** @type {{lastUpdated:number}} */ (this.meta.get(this.clientID)).lastUpdated)) {\n        // renew local clock\n        this.setLocalState(this.getLocalState())\n      }\n      /**\n       * @type {Array<number>}\n       */\n      const remove = []\n      this.meta.forEach((meta, clientid) => {\n        if (clientid !== this.clientID && outdatedTimeout <= now - meta.lastUpdated && this.states.has(clientid)) {\n          remove.push(clientid)\n        }\n      })\n      if (remove.length > 0) {\n        removeAwarenessStates(this, remove, 'timeout')\n      }\n    }, math.floor(outdatedTimeout / 10)))\n    doc.on('destroy', () => {\n      this.destroy()\n    })\n    this.setLocalState({})\n  }\n\n  destroy () {\n    this.emit('destroy', [this])\n    this.setLocalState(null)\n    super.destroy()\n    clearInterval(this._checkInterval)\n  }\n\n  /**\n   * @return {Object<string,any>|null}\n   */\n  getLocalState () {\n    return this.states.get(this.clientID) || null\n  }\n\n  /**\n   * @param {Object<string,any>|null} state\n   */\n  setLocalState (state) {\n    const clientID = this.clientID\n    const currLocalMeta = this.meta.get(clientID)\n    const clock = currLocalMeta === undefined ? 0 : currLocalMeta.clock + 1\n    const prevState = this.states.get(clientID)\n    if (state === null) {\n      this.states.delete(clientID)\n    } else {\n      this.states.set(clientID, state)\n    }\n    this.meta.set(clientID, {\n      clock,\n      lastUpdated: time.getUnixTime()\n    })\n    const added = []\n    const updated = []\n    const filteredUpdated = []\n    const removed = []\n    if (state === null) {\n      removed.push(clientID)\n    } else if (prevState == null) {\n      if (state != null) {\n        added.push(clientID)\n      }\n    } else {\n      updated.push(clientID)\n      if (!f.equalityDeep(prevState, state)) {\n        filteredUpdated.push(clientID)\n      }\n    }\n    if (added.length > 0 || filteredUpdated.length > 0 || removed.length > 0) {\n      this.emit('change', [{ added, updated: filteredUpdated, removed }, 'local'])\n    }\n    this.emit('update', [{ added, updated, removed }, 'local'])\n  }\n\n  /**\n   * @param {string} field\n   * @param {any} value\n   */\n  setLocalStateField (field, value) {\n    const state = this.getLocalState()\n    if (state !== null) {\n      this.setLocalState({\n        ...state,\n        [field]: value\n      })\n    }\n  }\n\n  /**\n   * @return {Map<number,Object<string,any>>}\n   */\n  getStates () {\n    return this.states\n  }\n}\n\n/**\n * Mark (remote) clients as inactive and remove them from the list of active peers.\n * This change will be propagated to remote clients.\n *\n * @param {Awareness} awareness\n * @param {Array<number>} clients\n * @param {any} origin\n */\nexport const removeAwarenessStates = (awareness, clients, origin) => {\n  const removed = []\n  for (let i = 0; i < clients.length; i++) {\n    const clientID = clients[i]\n    if (awareness.states.has(clientID)) {\n      awareness.states.delete(clientID)\n      if (clientID === awareness.clientID) {\n        const curMeta = /** @type {MetaClientState} */ (awareness.meta.get(clientID))\n        awareness.meta.set(clientID, {\n          clock: curMeta.clock + 1,\n          lastUpdated: time.getUnixTime()\n        })\n      }\n      removed.push(clientID)\n    }\n  }\n  if (removed.length > 0) {\n    awareness.emit('change', [{ added: [], updated: [], removed }, origin])\n    awareness.emit('update', [{ added: [], updated: [], removed }, origin])\n  }\n}\n\n/**\n * @param {Awareness} awareness\n * @param {Array<number>} clients\n * @return {Uint8Array}\n */\nexport const encodeAwarenessUpdate = (awareness, clients, states = awareness.states) => {\n  const len = clients.length\n  const encoder = encoding.createEncoder()\n  encoding.writeVarUint(encoder, len)\n  for (let i = 0; i < len; i++) {\n    const clientID = clients[i]\n    const state = states.get(clientID) || null\n    const clock = /** @type {MetaClientState} */ (awareness.meta.get(clientID)).clock\n    encoding.writeVarUint(encoder, clientID)\n    encoding.writeVarUint(encoder, clock)\n    encoding.writeVarString(encoder, JSON.stringify(state))\n  }\n  return encoding.toUint8Array(encoder)\n}\n\n/**\n * Modify the content of an awareness update before re-encoding it to an awareness update.\n *\n * This might be useful when you have a central server that wants to ensure that clients\n * cant hijack somebody elses identity.\n *\n * @param {Uint8Array} update\n * @param {function(any):any} modify\n * @return {Uint8Array}\n */\nexport const modifyAwarenessUpdate = (update, modify) => {\n  const decoder = decoding.createDecoder(update)\n  const encoder = encoding.createEncoder()\n  const len = decoding.readVarUint(decoder)\n  encoding.writeVarUint(encoder, len)\n  for (let i = 0; i < len; i++) {\n    const clientID = decoding.readVarUint(decoder)\n    const clock = decoding.readVarUint(decoder)\n    const state = JSON.parse(decoding.readVarString(decoder))\n    const modifiedState = modify(state)\n    encoding.writeVarUint(encoder, clientID)\n    encoding.writeVarUint(encoder, clock)\n    encoding.writeVarString(encoder, JSON.stringify(modifiedState))\n  }\n  return encoding.toUint8Array(encoder)\n}\n\n/**\n * @param {Awareness} awareness\n * @param {Uint8Array} update\n * @param {any} origin This will be added to the emitted change event\n */\nexport const applyAwarenessUpdate = (awareness, update, origin) => {\n  const decoder = decoding.createDecoder(update)\n  const timestamp = time.getUnixTime()\n  const added = []\n  const updated = []\n  const filteredUpdated = []\n  const removed = []\n  const len = decoding.readVarUint(decoder)\n  for (let i = 0; i < len; i++) {\n    const clientID = decoding.readVarUint(decoder)\n    let clock = decoding.readVarUint(decoder)\n    const state = JSON.parse(decoding.readVarString(decoder))\n    const clientMeta = awareness.meta.get(clientID)\n    const prevState = awareness.states.get(clientID)\n    const currClock = clientMeta === undefined ? 0 : clientMeta.clock\n    if (currClock < clock || (currClock === clock && state === null && awareness.states.has(clientID))) {\n      if (state === null) {\n        // never let a remote client remove this local state\n        if (clientID === awareness.clientID && awareness.getLocalState() != null) {\n          // remote client removed the local state. Do not remote state. Broadcast a message indicating\n          // that this client still exists by increasing the clock\n          clock++\n        } else {\n          awareness.states.delete(clientID)\n        }\n      } else {\n        awareness.states.set(clientID, state)\n      }\n      awareness.meta.set(clientID, {\n        clock,\n        lastUpdated: timestamp\n      })\n      if (clientMeta === undefined && state !== null) {\n        added.push(clientID)\n      } else if (clientMeta !== undefined && state === null) {\n        removed.push(clientID)\n      } else if (state !== null) {\n        if (!f.equalityDeep(state, prevState)) {\n          filteredUpdated.push(clientID)\n        }\n        updated.push(clientID)\n      }\n    }\n  }\n  if (added.length > 0 || filteredUpdated.length > 0 || removed.length > 0) {\n    awareness.emit('change', [{\n      added, updated: filteredUpdated, removed\n    }, origin])\n  }\n  if (added.length > 0 || updated.length > 0 || removed.length > 0) {\n    awareness.emit('update', [{\n      added, updated, removed\n    }, origin])\n  }\n}\n"],"names":["deepCopy","o","JSON","parse","stringify","YDocument","constructor","this","isDisposed","ydoc","source","getText","ystate","getMap","undoManager","trackedOrigins","Set","awareness","_changed","Signal","transact","f","undoable","dispose","destroy","canUndo","undoStack","length","canRedo","redoStack","undo","redo","clearUndoHistory","clear","YFile","super","_modelObserver","event","changes","sourceChange","delta","emit","_onStateChanged","stateChange","keysChanged","forEach","key","change","keys","get","push","name","oldValue","newValue","ysource","observe","unobserve","getSource","toString","setSource","value","ytext","delete","insert","updateSource","start","end","YNotebook","options","_onYCellsChanged","added","item","type","content","_ycellMapping","has","set","createCellFromType","cell","_notebook","disableDocumentWideUndoRedo","_undoManager","ymodel","deleted","model","index","cellsChange","d","insertedCells","map","ycell","cells","splice","retain","_onMetadataChanged","metadataChange","undefined","getMetadata","ycells","getArray","ymeta","Map","_disableDocumentWideUndoRedo","toArray","getCell","insertCell","insertCells","moveCell","fromIndex","toIndex","fromCell","clone","deleteCell","deleteCellRange","from","to","meta","orig_nbformat","setMetadata","updateMetadata","Object","assign","YCodeCell","YMarkdownCell","YRawCell","Error","createStandaloneCell","cellType","id","createStandalone","YBaseCell","isStandalone","events","sourceEvent","find","target","outputEvent","outputsChange","modelEvent","executionCountChange","_prevSourceLength","observeDeep","_a","notebook","doc","UUID","prototype","cell_type","create","getId","Self","unobserveDeep","getAttachments","setAttachments","attachments","toJSON","metadata","count","getOutputs","setOutputs","outputs","youtputs","updateOutputs","fin","execution_count","convertYMapEventToMapChange","action","createMutex","token","last","arr","appendTo","dest","src","i","Array","equalFlat","a","b","every","callAll","fs","args","nop","equalityFlat","equalityDeep","equalityStrict","ArrayBuffer","Uint8Array","byteLength","size","floor","Math","abs","ceil","log10","imul","round","add","log2","log","sqrt","min","max","isNegativeZero","Number","isNaN","pow","sign","n","obj","results","hasProperty","hasOwnProperty","call","val","Awareness","clientID","states","_checkInterval","setInterval","now","getLocalState","outdatedTimeout","lastUpdated","setLocalState","remove","clientid","removeAwarenessStates","on","clearInterval","state","currLocalMeta","clock","prevState","updated","filteredUpdated","removed","setLocalStateField","field","getStates","clients","origin","curMeta","encodeAwarenessUpdate","len","encoder","applyAwarenessUpdate","update","decoder","timestamp","clientMeta","currClock"],"sourceRoot":""}